<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="heinin" />

<meta name="date" content="2025-04-19" />

<title>Plots without Day 12</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PD1_mm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/heinin/PD1_mm">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Plots without Day 12</h1>
<h4 class="author">heinin</h4>
<h4 class="date">2025-04-19</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-04-28
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 5
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 2
</p>
<p>
<strong>Knit directory:</strong> <code>PD1_mm/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20240223code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20240223)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20240223code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20240223)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongabsolute">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>File paths:</strong> absolute </a>
</p>
</div>
<div id="strongFilepathsstrongabsolute" class="panel-collapse collapse">
<div class="panel-body">
<p>
Using absolute paths to the files within your workflowr project makes it
difficult for you and others to run your code on a different machine.
Change the absolute path(s) below to the suggested relative path(s) to
make your code more reproducible.
</p>
<table class="table table-condensed table-hover">
<thead>
<tr>
<th style="text-align:left;">
absolute
</th>
<th style="text-align:left;">
relative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
/home/hnatri/PD1_mm/
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
/home/hnatri/PD1_mm/code/utilities.R
</td>
<td style="text-align:left;">
code/utilities.R
</td>
</tr>
<tr>
<td style="text-align:left;">
/home/hnatri/PD1_mm/code/PD1_mm_themes.R
</td>
<td style="text-align:left;">
code/PD1_mm_themes.R
</td>
</tr>
<tr>
<td style="text-align:left;">
/home/hnatri/PD1_mm/code/CART_plot_functions.R
</td>
<td style="text-align:left;">
code/CART_plot_functions.R
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomheininPD1mmtree6984f3691c37f5617533c7ab818581c72d229067targetblank6984f36a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/heinin/PD1_mm/tree/6984f3691c37f5617533c7ab818581c72d229067" target="_blank">6984f36</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomheininPD1mmtree6984f3691c37f5617533c7ab818581c72d229067targetblank6984f36a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/heinin/PD1_mm/tree/6984f3691c37f5617533c7ab818581c72d229067" target="_blank">6984f36</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .RData

Unstaged changes:
    Modified:   analysis/cleaner_plots.Rmd
    Modified:   code/CellChat.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/cleaner_plots.Rmd</code>) and
HTML (<code>docs/cleaner_plots.html</code>) files. If you’ve configured
a remote Git repository (see <code>?wflow_git_remote</code>), click on
the hyperlinks in the table below to view the files as they were in that
past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/heinin/PD1_mm/blob/6984f3691c37f5617533c7ab818581c72d229067/analysis/cleaner_plots.Rmd" target="_blank">6984f36</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
<td>
Plotsize
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/heinin/PD1_mm/6984f3691c37f5617533c7ab818581c72d229067/docs/cleaner_plots.html" target="_blank">6984f36</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
<td>
Plotsize
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/heinin/PD1_mm/blob/fb5a81292ffffef6e95b999a48ff179dab166551/analysis/cleaner_plots.Rmd" target="_blank">fb5a812</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
<td>
Updated CellChat and GSEA, added plots without day 12
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/heinin/PD1_mm/fb5a81292ffffef6e95b999a48ff179dab166551/docs/cleaner_plots.html" target="_blank">fb5a812</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
<td>
Updated CellChat and GSEA, added plots without day 12
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Plotting feature expression comparisons etc. with Day 16 samples
only.</p>
</div>
<div id="packages-and-environment-variables" class="section level2">
<h2>Packages and environment variables</h2>
<pre class="r"><code>suppressPackageStartupMessages({
  library(Seurat)
  library(SeuratObject)
  library(SeuratDisk)
  library(tidyverse)
  library(tibble)
  library(ggplot2)
  library(ggpubr)
  library(workflowr)
  library(googlesheets4)
  library(CellChat)})

setwd(&quot;/home/hnatri/PD1_mm/&quot;)
set.seed(9999)
options(ggrepel.max.overlaps = Inf)
options(future.globals.maxSize = 30000 * 1024^2)

# Colors, themes, cell type markers, and plot functions
source(&quot;/home/hnatri/PD1_mm/code/utilities.R&quot;)
source(&quot;/home/hnatri/PD1_mm/code/PD1_mm_themes.R&quot;)
source(&quot;/home/hnatri/PD1_mm/code/CART_plot_functions.R&quot;)</code></pre>
</div>
<div id="helper-functions" class="section level2">
<h2>Helper functions</h2>
<pre class="r"><code># Calling DEGs between two groups for each cell type
get_DEGs &lt;- function(seuratdata, celltypes, groupvar, group1, group2){
  DEGlist &lt;- lapply(celltypes, function(xx){
    data_subset &lt;- subset(seuratdata, subset = celltype == xx)
    Idents(data_subset) &lt;- as.character(unlist(data_subset[[groupvar]]))
    
    if (min(table(unlist(data_subset[[groupvar]])))&lt;20){
      return(NULL)
    }
    
    if (all((c(group1, group2) %in% unlist(data_subset[[groupvar]]) == c(T, T)))){
      markers &lt;- FindMarkers(data_subset,
                             ident.1 = group1,
                             ident.2 = group2,
                             assay = &quot;RNA&quot;,
                             verbose = F)
      markers$feature &lt;- rownames(markers)
      markers$celltype &lt;- xx
      
      return(markers)
    } else {
      return(NULL)
    }
    })
  
  as.data.frame(do.call(rbind, DEGlist))
}</code></pre>
</div>
<div id="import-data" class="section level2">
<h2>Import data</h2>
<pre class="r"><code>seurat_data &lt;- readRDS(&quot;/tgen_labs/banovich/BCTCSF/PD1_mm_Seurat/PD1_mm_Seurat_GSEA.Rds&quot;)
DefaultAssay(seurat_data) &lt;- &quot;RNA&quot;

seurat_data &lt;- subset(seurat_data, subset = Day == 16)

seurat_data$Treatment &lt;- factor(seurat_data$Treatment,
                                levels = c(&quot;CTRL&quot;, &quot;NEO&quot;, &quot;ADJ&quot;))</code></pre>
</div>
<div id="feature-expression" class="section level2">
<h2>Feature expression</h2>
<div id="selected-lymphoid-markers" class="section level3">
<h3>Selected lymphoid markers</h3>
<pre class="r"><code>lymph_plot_features &lt;- c(&quot;Cd3e&quot;, &quot;Cd4&quot;, &quot;Cd8a&quot;, &quot;Tcf7&quot;, &quot;Ccr7&quot;, &quot;Pdcd1&quot;, &quot;Tigit&quot;,
                         &quot;Havcr2&quot;, &quot;Gzmb&quot;, &quot;Gzmk&quot;, &quot;Cx3cr1&quot;, &quot;Cxcr5&quot;, &quot;Foxp3&quot;,
                         &quot;Tnfrsf9&quot;, &quot;Ifng&quot;, &quot;Prf1&quot;, &quot;Cdc6&quot;, &quot;Lag3&quot;, &quot;Klrc1&quot;,
                         &quot;Klrg1&quot;, &quot;Tox&quot;, &quot;Slamf6&quot;, &quot;Xcl1&quot;, &quot;Mt1&quot;, &quot;Nfkbia&quot;,
                         &quot;Nr4a1&quot;, &quot;Cd69&quot;)

lymphoid &lt;- subset(seurat_data, subset = celltype %in% c(grep(&quot;^L&quot;, unique(seurat_data$celltype), value = T), c(&quot;NK&quot;, &quot;Treg&quot;, &quot;B1&quot;, &quot;B2&quot;)))
lymphoid$celltype &lt;- factor(lymphoid$celltype,
                            levels = sort(c(grep(&quot;^L&quot;, unique(lymphoid$celltype), value = T), c(&quot;NK&quot;, &quot;Treg&quot;, &quot;B1&quot;, &quot;B2&quot;))))

VlnPlot(lymphoid,
        features = lymph_plot_features,
        group.by = &quot;Treatment&quot;,
        cols = treatment_col,
        pt.size = 0,
        ncol = 5,
        slot = &quot;data&quot;) &amp;
  theme_classic() &amp;
  NoLegend() &amp;
  ylab(&quot;&quot;)</code></pre>
<p><img src="figure/cleaner_plots.Rmd/unnamed-chunk-4-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/heinin/PD1_mm/blob/6984f3691c37f5617533c7ab818581c72d229067/docs/figure/cleaner_plots.Rmd/unnamed-chunk-4-1.png" target="_blank">6984f36</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/heinin/PD1_mm/blob/fb5a81292ffffef6e95b999a48ff179dab166551/docs/figure/cleaner_plots.Rmd/unnamed-chunk-4-1.png" target="_blank">fb5a812</a>
</td>
<td>
heinin
</td>
<td>
2025-04-21
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="de-stats-lineage-level" class="section level3">
<h3>DE stats, lineage level</h3>
<p>ADJ vs. NEO</p>
<pre class="r"><code>Idents(lymphoid) &lt;- lymphoid$Treatment
    
markers &lt;- FindMarkers(lymphoid,
                       ident.1 = &quot;ADJ&quot;,
                       ident.2 = &quot;NEO&quot;,
                       assay = &quot;RNA&quot;,
                       verbose = F)
markers$feature &lt;- rownames(markers)

markers %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>        p_val avg_log2FC pct.1 pct.2 p_val_adj feature
Gzmc        0   2.836984 0.162 0.045     0.000    Gzmc
Gzmf        0   3.930203 0.025 0.004     0.000    Gzmf
Gm36888     0  -3.631396 0.001 0.018     0.000 Gm36888
Dgki        0  -2.339319 0.015 0.037     0.000    Dgki
Arg1        0   3.144504 0.033 0.013     0.000    Arg1
Tshz2       0  -2.104372 0.010 0.029     0.000   Tshz2
F10         0   2.254657 0.034 0.014     0.000     F10
Iglc1       0   2.340020 0.071 0.040     0.000   Iglc1
Rbms3       0  -2.061351 0.010 0.027     0.001   Rbms3
Gm10406     0  -2.449032 0.004 0.017     0.001 Gm10406
Trav7-4     0  -3.401053 0.002 0.011     0.005 Trav7-4
Ntn1        0  -2.542014 0.010 0.026     0.005    Ntn1
Gm3667      0  -2.327663 0.005 0.018     0.008  Gm3667
Ccl24       0   4.043596 0.030 0.013     0.009   Ccl24</code></pre>
<p>ADJ vs. NEO, T cell markers</p>
<pre class="r"><code>markers %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>        p_val avg_log2FC pct.1 pct.2 p_val_adj feature
Cd4     0.000 -1.1628684 0.188 0.357     0.000     Cd4
Tox     0.000 -0.7291804 0.617 0.707     0.000     Tox
Gzmb    0.000  1.1562579 0.432 0.312     0.000    Gzmb
Foxp3   0.000 -0.9808091 0.075 0.161     0.000   Foxp3
Klrc1   0.000  0.6128789 0.423 0.306     0.000   Klrc1
Xcl1    0.000  0.2754180 0.455 0.344     0.000    Xcl1
Tigit   0.000 -1.1356552 0.112 0.166     0.000   Tigit
Cd8a    0.000  0.3944113 0.347 0.275     0.000    Cd8a
Cx3cr1  0.000 -0.8054502 0.330 0.379     0.000  Cx3cr1
Ccr7    0.000  0.4867760 0.180 0.128     0.000    Ccr7
Prf1    0.000  0.3944871 0.354 0.289     0.000    Prf1
Tnfrsf9 0.000  0.2060815 0.383 0.317     0.002 Tnfrsf9
Cdc6    0.000  0.5727930 0.056 0.033     0.019    Cdc6
Klrg1   0.000 -0.5604058 0.077 0.108     0.050   Klrg1
Tcf7    0.000  0.1442359 0.450 0.395     0.060    Tcf7
Nr4a1   0.000 -0.7009271 0.078 0.108     0.114   Nr4a1
Cd3e    0.000 -0.1061116 0.645 0.706     1.000    Cd3e
Nfkbia  0.000  0.1898662 0.715 0.675     1.000  Nfkbia
Lag3    0.001 -0.3281816 0.360 0.375     1.000    Lag3
Slamf6  0.049 -0.1248160 0.357 0.378     1.000  Slamf6
Cxcr5   0.076  0.3890038 0.106 0.095     1.000   Cxcr5
Gzmk    0.134 -0.1606079 0.121 0.132     1.000    Gzmk
Pdcd1   0.589  0.1256223 0.267 0.266     1.000   Pdcd1</code></pre>
<p>ADJ vs. CTRL</p>
<pre class="r"><code>Idents(lymphoid) &lt;- lymphoid$Treatment
    
markers &lt;- FindMarkers(lymphoid,
                       ident.1 = &quot;ADJ&quot;,
                       ident.2 = &quot;CTRL&quot;,
                       assay = &quot;RNA&quot;,
                       verbose = F)
markers$feature &lt;- rownames(markers)

markers %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>         p_val avg_log2FC pct.1 pct.2 p_val_adj  feature
Igkc         0  -2.427291 0.201 0.544     0.000     Igkc
Ighg2c       0 -11.343798 0.001 0.090     0.000   Ighg2c
Ighg2b       0  -3.680714 0.015 0.112     0.000   Ighg2b
Jchain       0  -2.386996 0.009 0.054     0.000   Jchain
Ccdc160      0  -7.013639 0.000 0.032     0.000  Ccdc160
Slpi         0  -2.579524 0.042 0.110     0.000     Slpi
Cxcl2        0  -2.189619 0.012 0.044     0.000    Cxcl2
Ccl24        0   5.398647 0.030 0.008     0.000    Ccl24
Iglv1        0  -4.251857 0.010 0.033     0.000    Iglv1
Nuggc        0  -3.506658 0.001 0.015     0.000    Nuggc
Alpl         0  -3.365844 0.003 0.019     0.000     Alpl
Endou        0  -2.420099 0.005 0.020     0.000    Endou
Prg2         0  -2.999891 0.005 0.019     0.000     Prg2
Fkbp11       0  -2.895257 0.012 0.031     0.000   Fkbp11
Hbb-bs       0   3.702222 0.032 0.012     0.000   Hbb-bs
A4galt       0  -2.867945 0.002 0.013     0.000   A4galt
Prlr         0  -2.359166 0.003 0.015     0.000     Prlr
Il10         0  -2.027386 0.009 0.026     0.001     Il10
Gzmf         0   3.142878 0.025 0.009     0.001     Gzmf
Fmr1nb       0   2.109225 0.012 0.002     0.001   Fmr1nb
Cacna1h      0  -2.403738 0.002 0.013     0.002  Cacna1h
Igkv8-30     0  -3.335310 0.001 0.010     0.004 Igkv8-30
Derl3        0  -2.720553 0.013 0.030     0.006    Derl3
Iglv3        0  -2.085193 0.007 0.021     0.007    Iglv3</code></pre>
<p>ADJ vs. CTRL, T cell markers</p>
<pre class="r"><code>markers %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>        p_val avg_log2FC pct.1 pct.2 p_val_adj feature
Cd4     0.000 -1.0225989 0.188 0.304     0.000     Cd4
Cd8a    0.000  0.5093602 0.347 0.223     0.000    Cd8a
Klrc1   0.000  0.3487256 0.423 0.301     0.000   Klrc1
Xcl1    0.000  0.2740381 0.455 0.334     0.000    Xcl1
Foxp3   0.000 -0.8384133 0.075 0.141     0.000   Foxp3
Havcr2  0.000  0.3713601 0.294 0.202     0.000  Havcr2
Cx3cr1  0.000  0.4030943 0.330 0.243     0.000  Cx3cr1
Gzmb    0.000  0.2416828 0.432 0.348     0.000    Gzmb
Prf1    0.000  0.4731180 0.354 0.271     0.000    Prf1
Lag3    0.000  0.1415182 0.360 0.285     0.000    Lag3
Cd69    0.000  0.1004426 0.503 0.413     0.000    Cd69
Tcf7    0.000  0.1097990 0.450 0.378     0.015    Tcf7
Mt1     0.000 -0.1436174 0.218 0.174     0.534     Mt1
Pdcd1   0.000  0.2224907 0.267 0.231     1.000   Pdcd1
Cd3e    0.001 -0.1885721 0.645 0.638     1.000    Cd3e
Ccr7    0.006 -0.1829533 0.180 0.152     1.000    Ccr7
Klrg1   0.017 -0.6558645 0.077 0.091     1.000   Klrg1
Tox     0.026 -0.2220738 0.617 0.602     1.000     Tox
Tnfrsf9 0.042 -0.1730912 0.383 0.342     1.000 Tnfrsf9
Slamf6  0.117 -0.2951943 0.357 0.357     1.000  Slamf6
Tigit   0.167 -0.8256399 0.112 0.118     1.000   Tigit
Cxcr5   0.186  0.1183365 0.106 0.097     1.000   Cxcr5
Nfkbia  0.439 -0.1332977 0.715 0.683     1.000  Nfkbia
Nr4a1   0.616 -0.3638265 0.078 0.074     1.000   Nr4a1</code></pre>
<p>NEO vs. CTRL</p>
<pre class="r"><code>Idents(lymphoid) &lt;- lymphoid$Treatment
    
markers &lt;- FindMarkers(lymphoid,
                       ident.1 = &quot;NEO&quot;,
                       ident.2 = &quot;CTRL&quot;,
                       assay = &quot;RNA&quot;,
                       verbose = F)
markers$feature &lt;- rownames(markers)

markers %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>          p_val avg_log2FC pct.1 pct.2 p_val_adj   feature
Igkc          0  -3.439609 0.175 0.544     0.000      Igkc
Hspa1a        0   2.109542 0.173 0.035     0.000    Hspa1a
Ighg2b        0  -5.068184 0.008 0.112     0.000    Ighg2b
Ighg2c        0 -10.207438 0.002 0.090     0.000    Ighg2c
Jchain        0  -4.891345 0.006 0.054     0.000    Jchain
Slpi          0  -4.251533 0.037 0.110     0.000      Slpi
Ccdc160       0  -7.065486 0.000 0.032     0.000   Ccdc160
Hbb-bs        0   3.943695 0.052 0.012     0.000    Hbb-bs
Iglv1         0  -4.635130 0.006 0.033     0.000     Iglv1
Cxcl2         0  -2.113275 0.013 0.044     0.000     Cxcl2
Prg2          0  -5.232100 0.001 0.019     0.000      Prg2
Igha          0  -3.929116 0.010 0.035     0.000      Igha
Mzb1          0  -2.287025 0.078 0.127     0.000      Mzb1
Capn11        0   2.105790 0.029 0.006     0.000    Capn11
Nuggc         0  -4.107549 0.001 0.015     0.000     Nuggc
Gm32296       0   2.363270 0.017 0.002     0.000   Gm32296
Fkbp11        0  -3.292906 0.009 0.031     0.000    Fkbp11
Mcpt2         0  -6.735032 0.000 0.012     0.000     Mcpt2
Tomt          0   2.136715 0.020 0.004     0.000      Tomt
Derl3         0  -3.037184 0.010 0.030     0.000     Derl3
A4galt        0  -3.255612 0.001 0.013     0.000    A4galt
Prlr          0  -2.331953 0.002 0.015     0.000      Prlr
Arg1          0  -2.726279 0.013 0.034     0.000      Arg1
Gm30329       0   2.096938 0.021 0.005     0.000   Gm30329
Igkv8-30      0  -7.114394 0.000 0.010     0.000  Igkv8-30
Gpm6a         0  -2.348873 0.003 0.016     0.000     Gpm6a
Ly6k          0  -2.050396 0.018 0.040     0.000      Ly6k
Cacna1h       0  -2.174552 0.002 0.013     0.000   Cacna1h
Ccr10         0  -3.677845 0.002 0.012     0.000     Ccr10
Eef1akmt3     0  -2.064500 0.002 0.012     0.000 Eef1akmt3
Treml1        0   2.430267 0.011 0.001     0.000    Treml1
Scube1        0   2.261197 0.015 0.003     0.001    Scube1
Hba-a2        0   3.769625 0.017 0.004     0.002    Hba-a2
Gm5420        0   2.365173 0.011 0.002     0.002    Gm5420</code></pre>
<p>NEO vs. CTRL, T cell markers</p>
<pre class="r"><code>markers %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>        p_val avg_log2FC pct.1 pct.2 p_val_adj feature
Cx3cr1  0.000  1.2085445 0.379 0.243     0.000  Cx3cr1
Tox     0.000  0.5071066 0.707 0.602     0.000     Tox
Havcr2  0.000  0.4668878 0.300 0.202     0.000  Havcr2
Lag3    0.000  0.4696999 0.375 0.285     0.000    Lag3
Tigit   0.000  0.3100153 0.166 0.118     0.000   Tigit
Nr4a1   0.000  0.3371006 0.108 0.074     0.010   Nr4a1
Gzmb    0.000 -0.9145751 0.312 0.348     0.012    Gzmb
Gzmk    0.000  0.1716219 0.132 0.096     0.057    Gzmk
Cd8a    0.000  0.1149489 0.275 0.223     0.095    Cd8a
Cd69    0.000  0.1174883 0.468 0.413     0.619    Cd69
Nfkbia  0.000 -0.3231639 0.675 0.683     0.830  Nfkbia
Cd4     0.000  0.1402694 0.357 0.304     1.000     Cd4
Mt1     0.000 -0.2318590 0.216 0.174     1.000     Mt1
Ccr7    0.001 -0.6697293 0.128 0.152     1.000    Ccr7
Tnfrsf9 0.001 -0.3791727 0.317 0.342     1.000 Tnfrsf9
Cdc6    0.007 -0.6450483 0.033 0.044     1.000    Cdc6
Foxp3   0.017  0.1423959 0.161 0.141     1.000   Foxp3
Klrc1   0.427 -0.2641533 0.306 0.301     1.000   Klrc1
Cxcr5   0.662 -0.2706672 0.095 0.097     1.000   Cxcr5
Slamf6  0.768 -0.1703783 0.378 0.357     1.000  Slamf6</code></pre>
</div>
<div id="de-celltype-level" class="section level3">
<h3>DE, celltype level</h3>
<pre class="r"><code>VlnPlot(lymphoid,
        features = lymph_plot_features,
        group.by = &quot;celltype&quot;,
        split.by = &quot;Treatment&quot;,
        cols = treatment_col,
        pt.size = 0,
        ncol = 2,
        slot = &quot;data&quot;) &amp;
  theme_classic() &amp;
  NoLegend()</code></pre>
<p><img src="figure/cleaner_plots.Rmd/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="top-de-stats" class="section level3">
<h3>Top DE stats</h3>
<pre class="r"><code>ADJ_NEO_DEGs &lt;- get_DEGs(seuratdata = lymphoid,
                         celltypes = unique(lymphoid$celltype),
                         groupvar = &quot;Treatment&quot;,
                         group1 = &quot;ADJ&quot;,
                         group2 = &quot;NEO&quot;)

ADJ_CTRL_DEGs &lt;- get_DEGs(seuratdata = lymphoid,
                          celltypes = unique(lymphoid$celltype),
                          groupvar = &quot;Treatment&quot;,
                          group1 = &quot;ADJ&quot;,
                          group2 = &quot;CTRL&quot;)

NEO_CTRL_DEGs &lt;- get_DEGs(seuratdata = lymphoid,
                          celltypes = unique(lymphoid$celltype),
                          groupvar = &quot;Treatment&quot;,
                          group1 = &quot;NEO&quot;,
                          group2 = &quot;CTRL&quot;)

ADJ_NEO_DEGs_sig &lt;- ADJ_NEO_DEGs %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))

ADJ_CTRL_DEGs_sig &lt;- ADJ_CTRL_DEGs %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))

NEO_CTRL_DEGs_sig &lt;- NEO_CTRL_DEGs %&gt;%
  filter(p_val_adj &lt; 0.01,
         abs(avg_log2FC) &gt; 2) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<p>ADJ_NEO_DEGs_sig</p>
<pre class="r"><code>ADJ_NEO_DEGs_sig</code></pre>
<pre><code>          p_val avg_log2FC pct.1 pct.2 p_val_adj  feature celltype
Gzmc          0   2.247703 0.279 0.099     0.000     Gzmc       L2
Upp1          0   2.197145 0.065 0.013     0.001     Upp1       L2
Kazn          0  -3.041868 0.006 0.040     0.006     Kazn       L2
Gzmf          0   3.341912 0.056 0.011     0.006     Gzmf       L2
Gzmc1         0   3.495601 0.368 0.098     0.000     Gzmc       L3
Ankrd551      0  -2.121215 0.048 0.245     0.000  Ankrd55       L3
Igf1r1        0  -3.028026 0.067 0.245     0.004    Igf1r       L3
Ephx11        0  -2.460833 0.059 0.231     0.007    Ephx1       L3
Ifitm11       0   3.219412 0.331 0.112     0.008   Ifitm1       L3
Igfbp42       0   3.165333 0.109 0.023     0.000   Igfbp4       L1
Il18bp2       0   2.035272 0.135 0.040     0.000   Il18bp       L1
Ramp32        0   2.498040 0.144 0.046     0.000    Ramp3       L1
Ly6c11        0   3.827008 0.077 0.014     0.000    Ly6c1       L1
Trdv12        0   5.500320 0.035 0.002     0.001    Trdv1       L1
Xlr1          0   2.194104 0.061 0.014     0.003      Xlr       L1
Ly6k3         0   2.611786 0.147 0.028     0.000     Ly6k       L5
Gzmc3         0   2.371769 0.161 0.055     0.000     Gzmc       L5
Socs14        0   2.407447 0.489 0.253     0.000    Socs1       B1
AA4671975     0   2.860851 0.098 0.021     0.007 AA467197       NK
F107          0   2.500715 0.475 0.175     0.000      F10       L6</code></pre>
<p>ADJ_CTRL_DEGs_sig</p>
<pre class="r"><code>ADJ_CTRL_DEGs_sig</code></pre>
<pre><code>           p_val avg_log2FC pct.1 pct.2 p_val_adj   feature celltype
Igkc           0  -3.021476 0.080 0.492     0.000      Igkc       L2
Ighg2c         0  -6.207433 0.000 0.067     0.000    Ighg2c       L2
Ighg2b         0  -3.312011 0.010 0.090     0.000    Ighg2b       L2
Slpi           0  -3.515556 0.008 0.060     0.000      Slpi       L2
Ccdc160        0  -4.973592 0.000 0.030     0.000   Ccdc160       L2
Ighg2b1        0  -2.728806 0.015 0.191     0.000    Ighg2b       L3
Ighg2c1        0  -3.856444 0.000 0.137     0.000    Ighg2c       L3
Slpi1          0  -3.877307 0.011 0.141     0.001      Slpi       L3
Igfbp42        0   2.391818 0.109 0.025     0.000    Igfbp4       L1
Bend42         0   2.369382 0.070 0.011     0.000     Bend4       L1
Ighg2c2        0  -5.843222 0.000 0.062     0.000    Ighg2c       L1
Epas12         0   2.268204 0.072 0.018     0.001     Epas1       L1
Ighg2b2        0  -3.518580 0.007 0.067     0.001    Ighg2b       L1
Ighg2c3        0  -5.089293 0.000 0.111     0.000    Ighg2c       L5
Hspa1a3        0   2.243696 0.333 0.114     0.000    Hspa1a       L5
Ighg2b3        0  -2.728852 0.020 0.145     0.000    Ighg2b       L5
Slpi3          0  -2.372031 0.028 0.135     0.000      Slpi       L5
Hist1h2ap3     0  -2.031215 0.141 0.298     0.001 Hist1h2ap       L5
Ccdc1603       0  -3.914626 0.000 0.052     0.008   Ccdc160       L5
Jchain4        0  -2.091006 0.029 0.267     0.000    Jchain       B1
Ighg2c4        0 -11.006697 0.016 0.218     0.000    Ighg2c       B1
Dnm31          0  -3.624704 0.019 0.207     0.000      Dnm3       B1
Fkbp111        0  -3.056428 0.058 0.270     0.000    Fkbp11       B1
Sdc13          0  -2.482897 0.032 0.221     0.000      Sdc1       B1
Ighg2b4        0  -3.431426 0.064 0.270     0.000    Ighg2b       B1
Igkc4          0  -2.194740 0.939 0.984     0.000      Igkc       B1
Derl32         0  -3.428571 0.058 0.245     0.000     Derl3       B1
Alpl1          0  -3.599107 0.016 0.174     0.000      Alpl       B1
Nuggc          0  -3.769094 0.013 0.163     0.000     Nuggc       B1
Tram23         0  -2.030481 0.135 0.332     0.000     Tram2       B1
Gm55352        0  -4.503696 0.000 0.125     0.000    Gm5535       B1
Slpi4          0  -2.540647 0.061 0.240     0.000      Slpi       B1
Ankrd553       0  -3.061980 0.016 0.161     0.000   Ankrd55       B1
Mzb12          0  -2.048601 0.817 0.853     0.000      Mzb1       B1
Ckap42         0  -2.092585 0.167 0.360     0.000     Ckap4       B1
Bhlha15        0  -3.130430 0.016 0.155     0.000   Bhlha15       B1
Prdx44         0  -2.054560 0.215 0.398     0.000     Prdx4       B1
Oosp1          0  -2.201163 0.039 0.193     0.000     Oosp1       B1
Cpeb34         0  -2.399715 0.080 0.253     0.000     Cpeb3       B1
Spon13         0  -2.379285 0.071 0.234     0.000     Spon1       B1
Prlr           0  -2.689996 0.019 0.147     0.000      Prlr       B1
Prg21          0  -3.467120 0.026 0.161     0.000      Prg2       B1
Creb3l22       0  -2.006451 0.158 0.335     0.000   Creb3l2       B1
Endou1         0  -2.457837 0.026 0.158     0.000     Endou       B1
Ccr10          0  -3.064229 0.006 0.120     0.000     Ccr10       B1
Ada4           0  -2.226041 0.055 0.207     0.000       Ada       B1
Tspan15        0  -3.994726 0.000 0.101     0.000   Tspan15       B1
Pycr12         0  -2.034958 0.026 0.155     0.000     Pycr1       B1
A4galt1        0  -3.041123 0.010 0.117     0.001    A4galt       B1
Iglv12         0  -4.017254 0.096 0.251     0.001     Iglv1       B1
Dgkg3          0  -3.908325 0.016 0.125     0.002      Dgkg       B1
Cdkn2a4        0  -2.898267 0.026 0.144     0.002    Cdkn2a       B1
Tex143         0  -2.731133 0.116 0.267     0.002     Tex14       B1
Capn54         0  -2.036949 0.055 0.193     0.002     Capn5       B1
Coro2b3        0  -2.493796 0.010 0.109     0.004    Coro2b       B1
Faxc2          0  -3.341302 0.003 0.093     0.005      Faxc       B1
Etl42          0  -2.493660 0.013 0.112     0.009      Etl4       B1
Igkc5          0  -3.971785 0.043 0.423     0.000      Igkc       NK
Ighg2b5        0  -4.650380 0.003 0.076     0.000    Ighg2b       NK
S100a95        0  -3.006636 0.016 0.084     0.003    S100a9       NK
Igkc6          0  -3.907063 0.056 0.473     0.000      Igkc     Treg
Igkc9          0  -2.270560 0.188 0.634     0.000      Igkc       L6
Ighg2c9        0  -3.879195 0.000 0.161     0.006    Ighg2c       L6</code></pre>
<p>NEO_CTRL_DEGs_sig</p>
<pre class="r"><code>NEO_CTRL_DEGs_sig</code></pre>
<pre><code>         p_val avg_log2FC pct.1 pct.2 p_val_adj feature celltype
Igkc         0  -2.056543 0.076 0.492     0.000    Igkc       L2
Ighg2b       0  -3.986396 0.005 0.090     0.000  Ighg2b       L2
Ighg2c       0  -5.761500 0.000 0.067     0.000  Ighg2c       L2
Slpi         0  -3.618673 0.006 0.060     0.000    Slpi       L2
Gm21887      0  -3.190713 0.005 0.054     0.000 Gm21887       L2
Tcf7l21      0   2.989358 0.203 0.021     0.000  Tcf7l2       L3
Mef2c1       0   2.865070 0.357 0.133     0.001   Mef2c       L3
Ighg2b1      0  -3.428642 0.007 0.191     0.003  Ighg2b       L3
Hspa1b1      0   2.843902 0.287 0.087     0.005  Hspa1b       L3
Ighg2c2      0  -6.764026 0.000 0.062     0.000  Ighg2c       L1
Ighg2b2      0  -4.488340 0.004 0.067     0.000  Ighg2b       L1
Hspa1a1      0   2.323444 0.111 0.027     0.000  Hspa1a       L1
Slpi2        0  -3.147433 0.007 0.045     0.001    Slpi       L1
Ccdc1602     0  -5.558485 0.000 0.028     0.001 Ccdc160       L1
Hbb-bs2      0   2.092294 0.047 0.010     0.006  Hbb-bs       L1
Igkc2        0  -2.207690 0.126 0.574     0.000    Igkc       L5
Hspa1b3      0   2.355979 0.597 0.208     0.000  Hspa1b       L5
Hspa1a2      0   3.194849 0.479 0.114     0.000  Hspa1a       L5
Ighg2b3      0  -3.991778 0.008 0.145     0.000  Ighg2b       L5
Ighg2c3      0  -5.190445 0.001 0.111     0.000  Ighg2c       L5
Slpi3        0  -3.151352 0.018 0.135     0.000    Slpi       L5
Ccdc1603     0  -4.418815 0.000 0.052     0.000 Ccdc160       L5
Igkc3        0  -2.862303 0.920 0.984     0.000    Igkc       B1
Mzb12        0  -2.200306 0.727 0.853     0.000    Mzb1       B1
Jchain4      0  -4.245188 0.028 0.267     0.000  Jchain       B1
Derl32       0  -3.508613 0.028 0.245     0.000   Derl3       B1
Ighg2b4      0  -4.449218 0.048 0.270     0.000  Ighg2b       B1
Fkbp112      0  -3.296560 0.052 0.270     0.000  Fkbp11       B1
Alpl1        0  -4.549077 0.004 0.174     0.000    Alpl       B1
Ckap43       0  -2.478543 0.145 0.360     0.000   Ckap4       B1
Prg21        0  -4.710566 0.004 0.161     0.000    Prg2       B1
Ighg2c4      0  -9.530562 0.036 0.218     0.000  Ighg2c       B1
Cacna1s2     0  -2.422694 0.068 0.267     0.000 Cacna1s       B1
Slpi4        0  -6.641706 0.052 0.240     0.000    Slpi       B1
Sdc13        0  -2.253360 0.040 0.221     0.000    Sdc1       B1
Hspa1b4      0   3.599427 0.189 0.041     0.000  Hspa1b       B1
Nuggc        0  -3.491844 0.012 0.163     0.000   Nuggc       B1
Cpeb33       0  -2.997114 0.068 0.253     0.000   Cpeb3       B1
Pycr12       0  -3.012446 0.012 0.155     0.000   Pycr1       B1
Oosp1        0  -2.218229 0.032 0.193     0.000   Oosp1       B1
Iglv12       0  -4.024608 0.076 0.251     0.000   Iglv1       B1
Plpp54       0  -2.370895 0.056 0.223     0.000   Plpp5       B1
Asns3        0  -2.829620 0.024 0.169     0.001    Asns       B1
Hspa1a3      0   3.826414 0.137 0.022     0.001  Hspa1a       B1
Prdx44       0  -2.334924 0.241 0.398     0.001   Prdx4       B1
Endou2       0  -2.075531 0.020 0.158     0.001   Endou       B1
Prlr         0  -2.985046 0.016 0.147     0.002    Prlr       B1
Ccr10        0  -4.405466 0.004 0.120     0.002   Ccr10       B1
Cdkn2a3      0  -3.454196 0.016 0.144     0.002  Cdkn2a       B1
Gm55352      0  -3.421525 0.008 0.125     0.003  Gm5535       B1
A4galt1      0  -2.995080 0.004 0.117     0.003  A4galt       B1
Igha2        0  -4.053135 0.056 0.210     0.005    Igha       B1
Bhlha15      0  -2.334696 0.024 0.155     0.005 Bhlha15       B1
Spon14       0  -2.176663 0.080 0.234     0.008   Spon1       B1
Igkc4        0  -3.909083 0.033 0.423     0.000    Igkc       NK
Ighg2b5      0  -4.663957 0.002 0.076     0.000  Ighg2b       NK
Arg17        0  -5.260647 0.076 0.344     0.000    Arg1       L6
Ighg2c9      0  -3.975119 0.000 0.161     0.002  Ighg2c       L6
Arg26        0  -3.203293 0.035 0.247     0.004    Arg2       L6</code></pre>
</div>
<div id="t-cell-marker-de-stats" class="section level3">
<h3>T cell marker DE stats</h3>
<p>ADJ vs. NEO</p>
<pre class="r"><code>ADJ_NEO_DEGs %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>         p_val avg_log2FC pct.1 pct.2 p_val_adj feature celltype
Tox      0.000 -0.6504418 0.681 0.752     0.000     Tox       L2
Gzmk     0.000 -0.8323372 0.166 0.273     0.000    Gzmk       L2
Tnfrsf9  0.000  0.4725377 0.391 0.259     0.000 Tnfrsf9       L2
Klrc1    0.000  0.3443095 0.652 0.554     0.106   Klrc1       L2
Havcr2   0.000  0.5536169 0.272 0.180     0.110  Havcr2       L2
Gzmb     0.000  0.8273081 0.495 0.418     0.270    Gzmb       L2
Cd4      0.000 -0.9336161 0.054 0.107     0.407     Cd4       L2
Xcl1     0.000 -0.3711378 0.707 0.611     1.000    Xcl1       L2
Foxp3    0.000 -1.7772018 0.010 0.033     1.000   Foxp3       L2
Mt1      0.001  0.6588177 0.154 0.101     1.000     Mt1       L2
Cdc6     0.001  1.3983039 0.036 0.012     1.000    Cdc6       L2
Nfkbia   0.004  0.3215174 0.647 0.587     1.000  Nfkbia       L2
Ccr7     0.004  0.6280480 0.119 0.079     1.000    Ccr7       L2
Nr4a1    0.009 -1.2745680 0.034 0.059     1.000   Nr4a1       L2
Cx3cr1   0.013 -0.7311353 0.175 0.213     1.000  Cx3cr1       L2
Klrg1    0.021 -1.1139063 0.026 0.045     1.000   Klrg1       L2
Pdcd1    0.143  0.2211153 0.312 0.282     1.000   Pdcd1       L2
Cxcr5    0.185  0.2612392 0.049 0.037     1.000   Cxcr5       L2
Slamf6   0.385 -0.1212934 0.259 0.276     1.000  Slamf6       L2
Tigit    0.410 -0.5736222 0.104 0.112     1.000   Tigit       L2
Ifng     0.957 -0.4693014 0.310 0.290     1.000    Ifng       L2
Tox1     0.000 -1.0279153 0.788 0.923     0.000     Tox       L3
Klrc11   0.000  1.2501143 0.695 0.462     0.000   Klrc1       L3
Slamf61  0.000 -1.2341369 0.309 0.587     0.000  Slamf6       L3
Foxp31   0.000 -0.9489413 0.134 0.385     0.003   Foxp3       L3
Cd41     0.000 -0.7822480 0.260 0.524     0.026     Cd4       L3
Xcl11    0.000  1.4053677 0.580 0.385     0.138    Xcl1       L3
Klrg11   0.000 -0.8696780 0.100 0.280     0.175   Klrg1       L3
Tigit1   0.000 -1.0673614 0.323 0.524     0.684   Tigit       L3
Gzmb1    0.000  1.3028423 0.691 0.545     0.732    Gzmb       L3
Cd8a     0.000  0.7279083 0.662 0.497     1.000    Cd8a       L3
Nr4a11   0.000 -1.7909129 0.149 0.301     1.000   Nr4a1       L3
Cxcr51   0.022 -1.1110231 0.041 0.098     1.000   Cxcr5       L3
Havcr21  0.025  0.5969326 0.610 0.566     1.000  Havcr2       L3
Cx3cr11  0.027 -1.2586119 0.428 0.510     1.000  Cx3cr1       L3
Nfkbia1  0.058 -0.1404178 0.874 0.895     1.000  Nfkbia       L3
Cd69     0.069  0.4428588 0.673 0.615     1.000    Cd69       L3
Pdcd12   0.090  0.3507277 0.725 0.727     1.000   Pdcd1       L3
Gzmk1    0.140 -0.7336668 0.271 0.336     1.000    Gzmk       L3
Mt11     0.286  0.3249332 0.498 0.462     1.000     Mt1       L3
Ccr71    0.469  0.2881349 0.138 0.168     1.000    Ccr7       L3
Lag3     0.606 -0.3774534 0.643 0.636     1.000    Lag3       L3
Cdc61    0.698 -0.2801748 0.454 0.441     1.000    Cdc6       L3
Tnfrsf91 0.895  0.1306103 0.788 0.748     1.000 Tnfrsf9       L3
Tcf7     0.000  0.6406315 0.531 0.356     0.000    Tcf7       L1
Cd42     0.000 -0.6028011 0.515 0.647     0.000     Cd4       L1
Tigit2   0.000 -1.6625353 0.105 0.223     0.000   Tigit       L1
Ccr72    0.000  1.3321645 0.215 0.105     0.000    Ccr7       L1
Tox5     0.000 -0.6344658 0.753 0.838     0.000     Tox       L1
Nfkbia2  0.000  0.5520018 0.718 0.592     0.041  Nfkbia       L1
Slamf62  0.000  0.3406035 0.408 0.319     1.000  Slamf6       L1
Foxp32   0.002 -0.1835179 0.249 0.337     1.000   Foxp3       L1
Cd3e     0.002 -0.1639233 0.902 0.933     1.000    Cd3e       L1
Havcr22  0.005 -1.0044230 0.124 0.173     1.000  Havcr2       L1
Cd8a1    0.008  0.2914562 0.208 0.154     1.000    Cd8a       L1
Lag31    0.009 -0.6702851 0.168 0.215     1.000    Lag3       L1
Nr4a12   0.013 -0.5609386 0.065 0.101     1.000   Nr4a1       L1
Prf1     0.017  0.3063769 0.110 0.074     1.000    Prf1       L1
Ifng1    0.018 -0.3771696 0.107 0.149     1.000    Ifng       L1
Klrg12   0.076 -0.4132068 0.100 0.130     1.000   Klrg1       L1
Xcl12    0.116 -0.2951978 0.117 0.144     1.000    Xcl1       L1
Gzmb2    0.214  0.1701508 0.236 0.206     1.000    Gzmb       L1
Gzmk2    0.511  0.7692788 0.072 0.064     1.000    Gzmk       L1
Cxcr52   0.617  0.2341397 0.081 0.074     1.000   Cxcr5       L1
Tnfrsf92 0.619  0.4989742 0.335 0.358     1.000 Tnfrsf9       L1
Pdcd13   0.755  0.1064692 0.356 0.345     1.000   Pdcd1       L1
Mt12     0.825 -0.7675380 0.086 0.087     1.000     Mt1       L1
Cdc62    0.956 -0.3363661 0.011 0.010     1.000    Cdc6       L1
Cx3cr12  0.969 -0.2055428 0.198 0.192     1.000  Cx3cr1       L1
Cx3cr13  0.000 -0.5125011 0.962 0.979     0.000  Cx3cr1       L5
Cd43     0.000 -0.6254329 0.271 0.452     0.000     Cd4       L5
Klrc12   0.000  0.7146205 0.504 0.383     0.011   Klrc1       L5
Ccr73    0.000  1.0958580 0.181 0.094     0.132    Ccr7       L5
Tox6     0.000 -0.4666136 0.737 0.827     0.250     Tox       L5
Gzmb3    0.000  0.9571877 0.418 0.313     0.531    Gzmb       L5
Havcr23  0.000 -0.3291980 0.729 0.805     0.829  Havcr2       L5
Tcf71    0.000  0.4996557 0.574 0.485     1.000    Tcf7       L5
Xcl13    0.000  0.3330823 0.510 0.400     1.000    Xcl1       L5
Cd8a2    0.002  0.4148950 0.470 0.386     1.000    Cd8a       L5
Nr4a13   0.002 -1.3711875 0.102 0.160     1.000   Nr4a1       L5
Foxp33   0.004 -0.4815742 0.118 0.178     1.000   Foxp3       L5
Tigit3   0.004 -0.8598258 0.139 0.197     1.000   Tigit       L5
Lag32    0.007 -0.1681845 0.876 0.904     1.000    Lag3       L5
Cdc63    0.194  0.4462459 0.052 0.037     1.000    Cdc6       L5
Ifng2    0.207 -0.1907885 0.225 0.254     1.000    Ifng       L5
Klrg13   0.228 -0.5465523 0.066 0.084     1.000   Klrg1       L5
Cd691    0.296  0.2082472 0.600 0.569     1.000    Cd69       L5
Nfkbia3  0.299  0.1050889 0.886 0.886     1.000  Nfkbia       L5
Prf11    0.300  0.3279574 0.349 0.316     1.000    Prf1       L5
Tnfrsf93 0.327  0.3327867 0.376 0.347     1.000 Tnfrsf9       L5
Cxcr53   0.381 -0.2167963 0.100 0.115     1.000   Cxcr5       L5
Pdcd14   0.451  0.3926036 0.375 0.364     1.000   Pdcd1       L5
Gzmk3    0.588  0.4577843 0.189 0.181     1.000    Gzmk       L5
Klrc13   0.022  2.9614789 0.058 0.020     1.000   Klrc1       B1
Havcr24  0.027 -0.6850813 0.151 0.221     1.000  Havcr2       B1
Tox7     0.031 -0.5058824 0.077 0.133     1.000     Tox       B1
Cxcr54   0.075  0.3618752 0.553 0.498     1.000   Cxcr5       B1
Cx3cr14  0.091 -0.6825254 0.264 0.317     1.000  Cx3cr1       B1
Lag33    0.091 -0.2805386 0.203 0.265     1.000    Lag3       B1
Cdc64    0.172 -1.9863803 0.010 0.024     1.000    Cdc6       B1
Foxp34   0.237 -0.3240655 0.026 0.044     1.000   Foxp3       B1
Cd45     0.248 -0.7430964 0.077 0.104     1.000     Cd4       B1
Gzmk4    0.261  1.8779433 0.019 0.008     1.000    Gzmk       B1
Cd692    0.336  0.3570351 0.547 0.526     1.000    Cd69       B1
Cd3e1    0.346 -0.2603602 0.106 0.133     1.000    Cd3e       B1
Prf12    0.375  2.0950633 0.051 0.036     1.000    Prf1       B1
Nfkbia4  0.485  0.1018507 0.810 0.795     1.000  Nfkbia       B1
Tcf72    0.501 -0.7968426 0.051 0.064     1.000    Tcf7       B1
Ifng3    0.633  0.3986965 0.035 0.028     1.000    Ifng       B1
Slamf63  0.673  0.1229196 0.630 0.651     1.000  Slamf6       B1
Klrg14   0.729 -0.3259427 0.016 0.020     1.000   Klrg1       B1
Tnfrsf94 0.742  0.5879136 0.071 0.064     1.000 Tnfrsf9       B1
Cd8a3    0.779 -0.3353888 0.071 0.076     1.000    Cd8a       B1
Ccr74    0.812 -0.2459697 0.325 0.309     1.000    Ccr7       B1
Gzmb4    0.884  0.9505235 0.071 0.068     1.000    Gzmb       B1
Nr4a14   0.886  0.4516523 0.119 0.116     1.000   Nr4a1       B1
Xcl14    0.923  0.5088735 0.061 0.060     1.000    Xcl1       B1
Gzmb5    0.000  1.1153851 0.808 0.624     0.000    Gzmb       NK
Tnfrsf95 0.000  0.3782462 0.463 0.332     1.000 Tnfrsf9       NK
Cxcr55   0.007 -3.3722417 0.000 0.013     1.000   Cxcr5       NK
Cd3e2    0.008 -0.9680742 0.050 0.092     1.000    Cd3e       NK
Tox8     0.011 -0.1452895 0.724 0.747     1.000     Tox       NK
Lag34    0.019  0.4925201 0.100 0.058     1.000    Lag3       NK
Havcr25  0.059  0.6242178 0.033 0.015     1.000  Havcr2       NK
Cd49     0.101 -2.6363638 0.010 0.023     1.000     Cd4       NK
Cdc65    0.165  0.8643543 0.012 0.004     1.000    Cdc6       NK
Pdcd15   0.194 -1.6890988 0.005 0.013     1.000   Pdcd1       NK
Ccr75    0.211  0.3982488 0.017 0.008     1.000    Ccr7       NK
Mt13     0.238  0.6949289 0.043 0.029     1.000     Mt1       NK
Klrg15   0.372 -0.1647634 0.231 0.255     1.000   Klrg1       NK
Slamf64  0.545  0.2519382 0.123 0.111     1.000  Slamf6       NK
Tigit4   0.621 -0.2019243 0.112 0.119     1.000   Tigit       NK
Cx3cr15  0.686 -0.4208002 0.174 0.182     1.000  Cx3cr1       NK
Cd693    0.786 -0.1511118 0.323 0.305     1.000    Cd69       NK
Tcf73    0.934 -0.1492368 0.503 0.468     1.000    Tcf7       NK
Tnfrsf96 0.043  0.7028502 0.483 0.409     1.000 Tnfrsf9     Treg
Klrc14   0.059  2.9278859 0.062 0.020     1.000   Klrc1     Treg
Gzmb6    0.060  3.4333257 0.073 0.027     1.000    Gzmb     Treg
Nr4a15   0.079 -2.3120549 0.022 0.060     1.000   Nr4a1     Treg
Cd8a4    0.091  2.2684021 0.084 0.040     1.000    Cd8a     Treg
Cd410    0.094 -1.2078974 0.028 0.067     1.000     Cd4     Treg
Klrg16   0.123 -2.5746198 0.000 0.013     1.000   Klrg1     Treg
Slamf65  0.142 -0.6457116 0.062 0.107     1.000  Slamf6     Treg
Prf13    0.152  2.8416282 0.028 0.007     1.000    Prf1     Treg
Cxcr56   0.191  0.4922403 0.253 0.195     1.000   Cxcr5     Treg
Xcl15    0.213  1.0473765 0.051 0.087     1.000    Xcl1     Treg
Tox9     0.241 -2.2812213 0.073 0.107     1.000     Tox     Treg
Tcf74    0.250 -0.3174248 0.309 0.369     1.000    Tcf7     Treg
Tigit5   0.320 -1.8916074 0.017 0.034     1.000   Tigit     Treg
Foxp35   0.354 -1.0302895 0.022 0.040     1.000   Foxp3     Treg
Ccr76    0.395  0.1819580 0.921 0.913     1.000    Ccr7     Treg
Nfkbia5  0.697  0.1133307 0.876 0.946     1.000  Nfkbia     Treg
Pdcd16   0.722  0.2232405 0.101 0.114     1.000   Pdcd1     Treg
Cd694    0.723 -0.5013448 0.118 0.128     1.000    Cd69     Treg
Cd3e3    0.758  0.1446610 0.096 0.107     1.000    Cd3e     Treg
Gzmk5    0.834  0.8290155 0.017 0.020     1.000    Gzmk     Treg
Havcr26  0.856  0.3493914 0.146 0.161     1.000  Havcr2     Treg
Cxcr57   0.000  2.1596860 0.152 0.034     1.000   Cxcr5       B2
Cd695    0.001  1.0345276 0.456 0.291     1.000    Cd69       B2
Cd411    0.007 -0.5041363 0.468 0.606     1.000     Cd4       B2
Nr4a16   0.017  2.8373838 0.088 0.029     1.000   Nr4a1       B2
Ccr77    0.038  0.3135635 0.105 0.046     1.000    Ccr7       B2
Lag35    0.051 -0.2383471 0.708 0.800     1.000    Lag3       B2
Nfkbia6  0.076  0.8278320 0.643 0.606     1.000  Nfkbia       B2
Tcf75    0.097  1.1380611 0.058 0.023     1.000    Tcf7       B2
Havcr27  0.136  0.9429638 0.199 0.143     1.000  Havcr2       B2
Klrc15   0.147  0.8503998 0.053 0.023     1.000   Klrc1       B2
Cx3cr16  0.198  0.9656643 0.205 0.160     1.000  Cx3cr1       B2
Tnfrsf97 0.236 -2.1133733 0.023 0.046     1.000 Tnfrsf9       B2
Mt14     0.238  0.2771275 0.094 0.057     1.000     Mt1       B2
Slamf66  0.310 -0.2690069 0.515 0.543     1.000  Slamf6       B2
Cd3e4    0.312  0.4112700 0.099 0.069     1.000    Cd3e       B2
Foxp36   0.326 -1.0268751 0.006 0.017     1.000   Foxp3       B2
Gzmb7    0.347  0.4223561 0.070 0.046     1.000    Gzmb       B2
Tigit6   0.393  0.7197462 0.023 0.011     1.000   Tigit       B2
Pdcd17   0.550 -0.3559424 0.023 0.034     1.000   Pdcd1       B2
Xcl16    0.620  1.1452209 0.076 0.063     1.000    Xcl1       B2
Ifng4    0.662 -1.3725380 0.012 0.017     1.000    Ifng       B2
Gzmk6    0.711 -0.8069390 0.018 0.023     1.000    Gzmk       B2
Tox10    0.798 -0.1265907 0.094 0.103     1.000     Tox       B2
Gzmb8    0.003  2.1604800 0.340 0.125     1.000    Gzmb       L4
Havcr28  0.007  0.9358211 0.280 0.083     1.000  Havcr2       L4
Klrc16   0.017  1.0018601 0.360 0.167     1.000   Klrc1       L4
Cd8a5    0.043  1.3649347 0.260 0.111     1.000    Cd8a       L4
Tnfrsf98 0.076 -0.7577088 0.320 0.153     1.000 Tnfrsf9       L4
Cx3cr17  0.095  1.0268191 0.280 0.153     1.000  Cx3cr1       L4
Pdcd18   0.122  0.7695192 0.220 0.111     1.000   Pdcd1       L4
Prf14    0.158  0.6619036 0.300 0.181     1.000    Prf1       L4
Cd3e5    0.264 -0.3077625 0.340 0.431     1.000    Cd3e       L4
Lag36    0.348 -0.3961043 0.180 0.111     1.000    Lag3       L4
Nr4a17   0.418 -1.1870334 0.100 0.056     1.000   Nr4a1       L4
Klrg17   0.510 -1.0535964 0.020 0.042     1.000   Klrg1       L4
Cxcr58   0.510 -1.7020744 0.020 0.042     1.000   Cxcr5       L4
Tigit7   0.598  0.3470031 0.080 0.056     1.000   Tigit       L4
Slamf67  0.615 -0.4917922 0.200 0.153     1.000  Slamf6       L4
Cd696    0.624 -0.3751407 0.200 0.236     1.000    Cd69       L4
Gzmk7    0.667 -0.3705407 0.060 0.042     1.000    Gzmk       L4
Foxp37   0.717  0.8269706 0.040 0.028     1.000   Foxp3       L4
Nfkbia7  0.744 -0.6990574 0.280 0.222     1.000  Nfkbia       L4
Cdc66    0.795  2.1050199 0.020 0.014     1.000    Cdc6       L4
Tcf76    0.806 -0.3752742 0.380 0.319     1.000    Tcf7       L4
Ccr78    0.818 -0.8953911 0.060 0.069     1.000    Ccr7       L4
Mt15     0.883 -1.6961844 0.080 0.083     1.000     Mt1       L4
Tox11    0.883 -0.1641352 0.740 0.708     1.000     Tox       L4
Ifng5    0.921 -0.7244537 0.140 0.139     1.000    Ifng       L4
Xcl17    0.969  0.2519859 0.240 0.236     1.000    Xcl1       L4
Cd412    0.000 -1.1178358 0.300 0.567     0.052     Cd4       L6
Xcl18    0.000  2.2874633 0.469 0.287     1.000    Xcl1       L6
Cx3cr18  0.000 -0.8008515 0.719 0.795     1.000  Cx3cr1       L6
Tox12    0.001 -0.5169049 0.806 0.854     1.000     Tox       L6
Foxp38   0.002 -1.2562798 0.181 0.322     1.000   Foxp3       L6
Klrc17   0.002  1.1220937 0.431 0.292     1.000   Klrc1       L6
Tigit8   0.002 -1.3256641 0.144 0.275     1.000   Tigit       L6
Gzmb9    0.003  1.6514745 0.462 0.339     1.000    Gzmb       L6
Cd3e6    0.012 -0.2504455 0.831 0.953     1.000    Cd3e       L6
Prf15    0.015  0.9837839 0.369 0.246     1.000    Prf1       L6
Tcf77    0.025  0.3747961 0.581 0.456     1.000    Tcf7       L6
Ifng6    0.027  0.7542950 0.306 0.211     1.000    Ifng       L6
Nfkbia8  0.054  0.2797903 0.950 0.918     1.000  Nfkbia       L6
Klrg18   0.062 -1.1515869 0.094 0.164     1.000   Klrg1       L6
Mt16     0.068 -0.4856225 0.425 0.509     1.000     Mt1       L6
Nr4a18   0.087 -0.9472928 0.181 0.257     1.000   Nr4a1       L6
Cd8a6    0.129  0.5160862 0.400 0.316     1.000    Cd8a       L6
Slamf68  0.423  0.1941344 0.613 0.602     1.000  Slamf6       L6
Ccr79    0.428  0.5725915 0.144 0.117     1.000    Ccr7       L6
Pdcd19   0.466  0.7021186 0.344 0.333     1.000   Pdcd1       L6
Havcr29  0.495  0.1630509 0.637 0.637     1.000  Havcr2       L6
Cxcr59   0.630  0.2218904 0.056 0.070     1.000   Cxcr5       L6
Lag37    0.706 -0.2532949 0.344 0.345     1.000    Lag3       L6</code></pre>
<p>ADJ vs. CTRL</p>
<pre class="r"><code>ADJ_CTRL_DEGs %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>         p_val avg_log2FC pct.1 pct.2 p_val_adj feature celltype
Havcr2   0.000  0.7799608 0.272 0.151     0.000  Havcr2       L2
Tox      0.000 -0.4140746 0.681 0.747     0.046     Tox       L2
Mt1      0.000  0.6440445 0.154 0.085     0.244     Mt1       L2
Tnfrsf9  0.000  0.3329816 0.391 0.288     0.299 Tnfrsf9       L2
Gzmb     0.000  0.6121977 0.495 0.419     1.000    Gzmb       L2
Pdcd1    0.000  0.5835132 0.312 0.233     1.000   Pdcd1       L2
Klrc1    0.000  0.1979877 0.652 0.561     1.000   Klrc1       L2
Lag3     0.002  0.2813607 0.328 0.257     1.000    Lag3       L2
Tcf7     0.025 -0.1603128 0.535 0.590     1.000    Tcf7       L2
Cx3cr1   0.057  0.3564708 0.175 0.143     1.000  Cx3cr1       L2
Gzmk     0.084 -0.5024717 0.166 0.191     1.000    Gzmk       L2
Cdc6     0.091  0.1266219 0.036 0.022     1.000    Cdc6       L2
Cd4      0.196 -0.5976659 0.054 0.067     1.000     Cd4       L2
Slamf6   0.215 -0.3145118 0.259 0.275     1.000  Slamf6       L2
Foxp3    0.271 -0.6347375 0.010 0.015     1.000   Foxp3       L2
Tigit    0.323 -0.2199133 0.104 0.089     1.000   Tigit       L2
Nr4a1    0.727 -0.9680952 0.034 0.037     1.000   Nr4a1       L2
Prf1     0.741  0.1009931 0.381 0.360     1.000    Prf1       L2
Cxcr5    0.758 -0.1104297 0.049 0.052     1.000   Cxcr5       L2
Klrg1    0.866 -0.4318697 0.026 0.027     1.000   Klrg1       L2
Xcl1     0.927 -0.2067402 0.707 0.672     1.000    Xcl1       L2
Ifng     0.963 -0.2278954 0.310 0.296     1.000    Ifng       L2
Klrc11   0.000  0.8743148 0.695 0.432     0.000   Klrc1       L3
Cd41     0.000 -0.6467705 0.260 0.444     0.672     Cd4       L3
Foxp31   0.000 -0.7337559 0.134 0.286     1.000   Foxp3       L3
Cd8a     0.000  0.4503878 0.662 0.452     1.000    Cd8a       L3
Pdcd12   0.001  0.6481570 0.725 0.697     1.000   Pdcd1       L3
Klrg11   0.001 -1.4631692 0.100 0.199     1.000   Klrg1       L3
Havcr21  0.003  0.5370121 0.610 0.485     1.000  Havcr2       L3
Slamf61  0.004 -0.5966195 0.309 0.415     1.000  Slamf6       L3
Prf11    0.010  0.5741418 0.424 0.307     1.000    Prf1       L3
Xcl11    0.010  0.5178428 0.580 0.456     1.000    Xcl1       L3
Gzmk1    0.042  0.4287807 0.271 0.191     1.000    Gzmk       L3
Ifng1    0.058  0.6809308 0.520 0.432     1.000    Ifng       L3
Gzmb1    0.172 -0.1863809 0.691 0.593     1.000    Gzmb       L3
Cd69     0.185  0.1200622 0.673 0.627     1.000    Cd69       L3
Tox1     0.205  0.1806412 0.788 0.776     1.000     Tox       L3
Cxcr51   0.206 -0.7345712 0.041 0.066     1.000   Cxcr5       L3
Ccr7     0.294 -0.2684903 0.138 0.170     1.000    Ccr7       L3
Nr4a11   0.294 -0.5506905 0.149 0.178     1.000   Nr4a1       L3
Tcf71    0.358  0.1845772 0.312 0.282     1.000    Tcf7       L3
Tigit1   0.381 -0.4567251 0.323 0.340     1.000   Tigit       L3
Nfkbia   0.526 -0.2705177 0.874 0.851     1.000  Nfkbia       L3
Cx3cr11  0.623  0.2098645 0.428 0.411     1.000  Cx3cr1       L3
Cdc61    0.902 -0.2510781 0.454 0.415     1.000    Cdc6       L3
Tcf72    0.000  0.6861616 0.531 0.344     0.000    Tcf7       L1
Cd3e     0.000 -0.3222187 0.902 0.932     0.000    Cd3e       L1
Cd8a1    0.000  1.0565559 0.208 0.097     0.000    Cd8a       L1
Cd42     0.000 -0.4858502 0.515 0.646     0.000     Cd4       L1
Ccr71    0.000  0.9483306 0.215 0.115     0.001    Ccr7       L1
Tigit2   0.000 -1.2527594 0.105 0.161     1.000   Tigit       L1
Xcl12    0.001  0.4226218 0.117 0.070     1.000    Xcl1       L1
Cd691    0.012  0.2072341 0.462 0.376     1.000    Cd69       L1
Gzmb2    0.014 -1.3046155 0.236 0.272     1.000    Gzmb       L1
Nfkbia1  0.038  0.1888355 0.718 0.635     1.000  Nfkbia       L1
Cx3cr12  0.052  0.2534952 0.198 0.156     1.000  Cx3cr1       L1
Klrg12   0.063 -0.6654757 0.100 0.131     1.000   Klrg1       L1
Havcr22  0.066 -0.8924683 0.124 0.151     1.000  Havcr2       L1
Tnfrsf91 0.111  0.1335216 0.335 0.381     1.000 Tnfrsf9       L1
Cxcr52   0.134  0.3773284 0.081 0.061     1.000   Cxcr5       L1
Lag31    0.214 -0.4750759 0.168 0.185     1.000    Lag3       L1
Pdcd13   0.230  0.1329983 0.356 0.323     1.000   Pdcd1       L1
Nr4a12   0.322 -0.6588272 0.065 0.077     1.000   Nr4a1       L1
Ifng2    0.424 -0.4909628 0.107 0.118     1.000    Ifng       L1
Mt11     0.886 -0.5738583 0.086 0.085     1.000     Mt1       L1
Cx3cr13  0.000 -0.3435778 0.962 0.983     0.034  Cx3cr1       L5
Tcf73    0.000  0.5892275 0.574 0.433     1.000    Tcf7       L5
Cd8a2    0.000  0.4020592 0.470 0.318     1.000    Cd8a       L5
Cd43     0.000 -0.3887563 0.271 0.391     1.000     Cd4       L5
Klrc12   0.001  0.5463433 0.504 0.384     1.000   Klrc1       L5
Foxp32   0.002 -0.6096731 0.118 0.197     1.000   Foxp3       L5
Cd692    0.003  0.4457874 0.600 0.491     1.000    Cd69       L5
Prf12    0.018  0.4082008 0.349 0.260     1.000    Prf1       L5
Ccr72    0.030  0.6602647 0.181 0.125     1.000    Ccr7       L5
Lag32    0.040 -0.2500208 0.876 0.893     1.000    Lag3       L5
Gzmk2    0.123  0.4290496 0.189 0.145     1.000    Gzmk       L5
Gzmb3    0.161  0.5443841 0.418 0.370     1.000    Gzmb       L5
Ifng3    0.173 -0.6268447 0.225 0.263     1.000    Ifng       L5
Pdcd14   0.193  0.5497254 0.375 0.336     1.000   Pdcd1       L5
Havcr23  0.202 -0.1282375 0.729 0.765     1.000  Havcr2       L5
Klrg13   0.340 -0.9024941 0.066 0.083     1.000   Klrg1       L5
Tigit3   0.443 -0.3963427 0.139 0.114     1.000   Tigit       L5
Nr4a13   0.450 -0.2673756 0.102 0.118     1.000   Nr4a1       L5
Tnfrsf92 0.619 -0.1853175 0.376 0.377     1.000 Tnfrsf9       L5
Cdc62    0.810 -0.3733153 0.052 0.055     1.000    Cdc6       L5
Cxcr53   0.000  0.5921482 0.553 0.384     1.000   Cxcr5       B1
Prf13    0.000  0.1021095 0.051 0.142     1.000    Prf1       B1
Mt12     0.001 -1.9456477 0.119 0.213     1.000     Mt1       B1
Cdc63    0.001 -2.8862675 0.010 0.054     1.000    Cdc6       B1
Ccr73    0.005  0.4805694 0.325 0.218     1.000    Ccr7       B1
Cd693    0.008  0.4301525 0.547 0.471     1.000    Cd69       B1
Nr4a14   0.008  0.1046540 0.119 0.060     1.000   Nr4a1       B1
Tcf74    0.036  1.4207488 0.051 0.022     1.000    Tcf7       B1
Cd3e1    0.095  0.6449256 0.106 0.071     1.000    Cd3e       B1
Cx3cr14  0.095  0.5515086 0.264 0.221     1.000  Cx3cr1       B1
Gzmk3    0.098  0.4287560 0.019 0.005     1.000    Gzmk       B1
Havcr24  0.128  0.3215387 0.151 0.112     1.000  Havcr2       B1
Lag33    0.282  0.3203328 0.203 0.174     1.000    Lag3       B1
Cd45     0.295  0.1251449 0.077 0.057     1.000     Cd4       B1
Pdcd15   0.303  0.1034806 0.061 0.044     1.000   Pdcd1       B1
Klrc13   0.369  1.0181903 0.058 0.044     1.000   Klrc1       B1
Xcl13    0.487  0.1697688 0.061 0.049     1.000    Xcl1       B1
Slamf62  0.515  0.2037042 0.630 0.668     1.000  Slamf6       B1
Foxp33   0.544  1.4570845 0.026 0.019     1.000   Foxp3       B1
Tigit4   0.551 -0.4307026 0.023 0.030     1.000   Tigit       B1
Tnfrsf93 0.564  0.5405554 0.071 0.060     1.000 Tnfrsf9       B1
Ifng4    0.722 -1.1271349 0.035 0.030     1.000    Ifng       B1
Gzmb4    0.731  1.0983044 0.071 0.079     1.000    Gzmb       B1
Tox5     0.924  0.3029677 0.077 0.076     1.000     Tox       B1
Klrg14   0.983  0.2477192 0.016 0.016     1.000   Klrg1       B1
Gzmb5    0.000  0.3234527 0.808 0.692     0.050    Gzmb       NK
Klrg15   0.004  0.4258810 0.231 0.161     1.000   Klrg1       NK
Cxcr54   0.005 -3.3146647 0.000 0.013     1.000   Cxcr5       NK
Cx3cr15  0.014  0.4287070 0.174 0.120     1.000  Cx3cr1       NK
Cd694    0.016  0.2495713 0.323 0.250     1.000    Cd69       NK
Prf14    0.037  0.2839899 0.872 0.868     1.000    Prf1       NK
Klrc14   0.068 -0.3727941 0.454 0.489     1.000   Klrc1       NK
Tnfrsf94 0.088  0.1113233 0.463 0.394     1.000 Tnfrsf9       NK
Cd8a3    0.098  1.7093902 0.028 0.013     1.000    Cd8a       NK
Havcr25  0.105  0.2024525 0.033 0.017     1.000  Havcr2       NK
Tcf75    0.202 -0.2551249 0.503 0.495     1.000    Tcf7       NK
Lag34    0.224  0.1536563 0.100 0.078     1.000    Lag3       NK
Cdc64    0.267  1.2666305 0.012 0.006     1.000    Cdc6       NK
Nr4a15   0.474  0.4930149 0.085 0.073     1.000   Nr4a1       NK
Cd3e2    0.527  0.4024128 0.050 0.042     1.000    Cd3e       NK
Cd49     0.640 -0.4945666 0.010 0.013     1.000     Cd4       NK
Tigit5   0.647 -0.2344798 0.112 0.099     1.000   Tigit       NK
Gzmk4    0.768  0.1287008 0.062 0.067     1.000    Gzmk       NK
Klrg16   0.036 -2.1776878 0.000 0.025     1.000   Klrg1     Treg
Tcf76    0.108 -0.5162351 0.309 0.379     1.000    Tcf7     Treg
Klrc15   0.129  1.2782813 0.062 0.030     1.000   Klrc1     Treg
Havcr26  0.183  1.0581798 0.146 0.108     1.000  Havcr2     Treg
Prf15    0.187  2.3453431 0.028 0.010     1.000    Prf1     Treg
Cd695    0.197 -0.2686746 0.118 0.079     1.000    Cd69     Treg
Cd410    0.213 -0.4037791 0.028 0.054     1.000     Cd4     Treg
Cd8a4    0.327  0.3805710 0.084 0.059     1.000    Cd8a     Treg
Nr4a16   0.343 -0.7738862 0.022 0.039     1.000   Nr4a1     Treg
Ccr74    0.382 -0.1022489 0.921 0.916     1.000    Ccr7     Treg
Mt13     0.458 -0.1671528 0.410 0.438     1.000     Mt1     Treg
Cxcr55   0.501 -0.4329890 0.253 0.276     1.000   Cxcr5     Treg
Cdc65    0.554  0.4232354 0.017 0.010     1.000    Cdc6     Treg
Lag35    0.586  0.4622947 0.152 0.138     1.000    Lag3     Treg
Tigit6   0.587 -0.9463099 0.017 0.025     1.000   Tigit     Treg
Ifng5    0.665 -0.6246403 0.022 0.030     1.000    Ifng     Treg
Foxp34   0.673 -0.2109742 0.022 0.030     1.000   Foxp3     Treg
Cx3cr16  0.852 -0.1835889 0.202 0.192     1.000  Cx3cr1     Treg
Gzmk5    0.854  1.5757792 0.017 0.020     1.000    Gzmk     Treg
Pdcd16   0.882  0.6260222 0.101 0.099     1.000   Pdcd1     Treg
Slamf63  0.887  0.6256596 0.062 0.059     1.000  Slamf6     Treg
Xcl14    0.947  0.9897485 0.051 0.049     1.000    Xcl1     Treg
Tox6     0.950 -0.3794448 0.073 0.074     1.000     Tox     Treg
Cd696    0.009  0.8163107 0.456 0.337     1.000    Cd69       B2
Cxcr56   0.019  0.8015888 0.152 0.074     1.000   Cxcr5       B2
Gzmb6    0.024  1.8097992 0.070 0.021     1.000    Gzmb       B2
Xcl15    0.032  0.3780306 0.076 0.026     1.000    Xcl1       B2
Klrg17   0.057 -2.7115449 0.000 0.021     1.000   Klrg1       B2
Nr4a17   0.071  1.5231330 0.088 0.042     1.000   Nr4a1       B2
Tox7     0.099 -0.3966548 0.094 0.047     1.000     Tox       B2
Klrc16   0.104  1.7264164 0.053 0.021     1.000   Klrc1       B2
Havcr27  0.112  0.6767086 0.199 0.137     1.000  Havcr2       B2
Slamf64  0.117 -0.5036627 0.515 0.511     1.000  Slamf6       B2
Cd411    0.214 -0.3750931 0.468 0.495     1.000     Cd4       B2
Gzmk6    0.269  0.5054188 0.018 0.005     1.000    Gzmk       B2
Cx3cr17  0.307  0.4487088 0.205 0.168     1.000  Cx3cr1       B2
Tigit7   0.335  0.9449038 0.023 0.011     1.000   Tigit       B2
Mt14     0.388 -1.5428333 0.094 0.116     1.000     Mt1       B2
Cd3e3    0.546  0.8816929 0.099 0.084     1.000    Cd3e       B2
Pdcd17   0.600  0.9569992 0.023 0.016     1.000   Pdcd1       B2
Cdc66    0.623 -0.9303982 0.006 0.011     1.000    Cdc6       B2
Prf16    0.636 -0.1419947 0.029 0.021     1.000    Prf1       B2
Cd8a5    0.644 -0.5320279 0.363 0.368     1.000    Cd8a       B2
Ifng6    0.731 -1.1142691 0.012 0.016     1.000    Ifng       B2
Tnfrsf95 0.831 -1.0418923 0.023 0.026     1.000 Tnfrsf9       B2
Ccr75    0.893 -1.8439914 0.105 0.095     1.000    Ccr7       B2
Klrc17   0.002  2.1157814 0.360 0.109     1.000   Klrc1       L4
Prf17    0.041  2.0583344 0.300 0.145     1.000    Prf1       L4
Cd3e4    0.055 -0.9740433 0.340 0.473     1.000    Cd3e       L4
Tox8     0.070  0.5663757 0.740 0.564     1.000     Tox       L4
Mt15     0.151  0.9523764 0.080 0.018     1.000     Mt1       L4
Cd8a6    0.171  0.9237234 0.260 0.145     1.000    Cd8a       L4
Tcf77    0.206  0.1526406 0.380 0.236     1.000    Tcf7       L4
Cx3cr18  0.240  0.2082742 0.280 0.164     1.000  Cx3cr1       L4
Gzmk7    0.266  2.4139942 0.060 0.018     1.000    Gzmk       L4
Nfkbia2  0.291 -0.8101770 0.280 0.345     1.000  Nfkbia       L4
Foxp35   0.296 -1.4201004 0.040 0.091     1.000   Foxp3       L4
Tnfrsf96 0.298 -0.8198271 0.320 0.200     1.000 Tnfrsf9       L4
Gzmb7    0.301 -0.3932916 0.340 0.236     1.000    Gzmb       L4
Cxcr57   0.303  2.0275635 0.020 0.000     1.000   Cxcr5       L4
Klrg18   0.358 -3.2354888 0.020 0.055     1.000   Klrg1       L4
Nr4a18   0.407 -0.3581242 0.100 0.055     1.000   Nr4a1       L4
Havcr28  0.417 -0.2280128 0.280 0.200     1.000  Havcr2       L4
Xcl16    0.473  0.5213752 0.240 0.182     1.000    Xcl1       L4
Cd412    0.477 -0.3621682 0.200 0.255     1.000     Cd4       L4
Ccr76    0.578  0.7856746 0.060 0.036     1.000    Ccr7       L4
Cdc67    0.641 -0.2192774 0.020 0.036     1.000    Cdc6       L4
Ifng7    0.648 -1.1444746 0.140 0.164     1.000    Ifng       L4
Pdcd18   0.666  0.1672336 0.220 0.182     1.000   Pdcd1       L4
Cd697    0.718  0.5881162 0.200 0.182     1.000    Cd69       L4
Slamf65  0.734 -0.2720778 0.200 0.164     1.000  Slamf6       L4
Lag36    0.871 -0.8255871 0.180 0.182     1.000    Lag3       L4
Tigit8   0.950 -0.8912377 0.080 0.073     1.000   Tigit       L4
Mt16     0.007 -1.1572190 0.425 0.548     1.000     Mt1       L6
Ifng8    0.007  1.3439811 0.306 0.161     1.000    Ifng       L6
Tcf78    0.008  0.6510756 0.581 0.419     1.000    Tcf7       L6
Cd8a7    0.016  1.0807004 0.400 0.258     1.000    Cd8a       L6
Xcl17    0.020  1.6422979 0.469 0.333     1.000    Xcl1       L6
Foxp36   0.022 -0.8852514 0.181 0.301     1.000   Foxp3       L6
Cd413    0.045 -0.7548615 0.300 0.409     1.000     Cd4       L6
Nfkbia3  0.048 -0.4458112 0.950 0.957     1.000  Nfkbia       L6
Ccr77    0.125  0.3529547 0.144 0.075     1.000    Ccr7       L6
Klrg19   0.159 -1.1058814 0.094 0.151     1.000   Klrg1       L6
Slamf66  0.194  0.3261030 0.613 0.548     1.000  Slamf6       L6
Pdcd19   0.252  1.0851549 0.344 0.301     1.000   Pdcd1       L6
Klrc18   0.320  0.2847168 0.431 0.376     1.000   Klrc1       L6
Cd698    0.321  0.4970412 0.650 0.602     1.000    Cd69       L6
Cd3e5    0.333  0.1623472 0.831 0.828     1.000    Cd3e       L6
Havcr29  0.340  0.1202587 0.637 0.548     1.000  Havcr2       L6
Cdc68    0.383  0.3196372 0.056 0.032     1.000    Cdc6       L6
Gzmk8    0.435  0.2850284 0.169 0.129     1.000    Gzmk       L6
Tnfrsf97 0.442 -0.6143672 0.456 0.495     1.000 Tnfrsf9       L6
Tigit9   0.538 -0.2755016 0.144 0.172     1.000   Tigit       L6
Cxcr58   0.553 -0.5320764 0.056 0.075     1.000   Cxcr5       L6
Tox9     0.828 -0.1759592 0.806 0.753     1.000     Tox       L6
Lag37    0.886  0.3986647 0.344 0.344     1.000    Lag3       L6</code></pre>
<p>NEO vs. CTRL</p>
<pre class="r"><code>NEO_CTRL_DEGs %&gt;%
  filter(feature %in% lymph_plot_features) %&gt;%
  mutate(p_val = round(p_val, 3),
         p_val_adj = round(p_val_adj, 3))</code></pre>
<pre><code>         p_val avg_log2FC pct.1 pct.2 p_val_adj feature celltype
Cx3cr1   0.000  1.0876061 0.213 0.143     1.000  Cx3cr1       L2
Gzmk     0.000  0.3298655 0.273 0.191     1.000    Gzmk       L2
Xcl1     0.000  0.1643976 0.611 0.672     1.000    Xcl1       L2
Cd4      0.005  0.3359502 0.107 0.067     1.000     Cd4       L2
Nfkbia   0.005 -0.3858675 0.587 0.629     1.000  Nfkbia       L2
Tcf7     0.016 -0.1542251 0.520 0.590     1.000    Tcf7       L2
Foxp3    0.019  1.1424643 0.033 0.015     1.000   Foxp3       L2
Pdcd1    0.020  0.3623979 0.282 0.233     1.000   Pdcd1       L2
Ccr7     0.022 -0.6753696 0.079 0.111     1.000    Ccr7       L2
Nr4a1    0.037  0.3064727 0.059 0.037     1.000   Nr4a1       L2
Klrg1    0.049  0.6820366 0.045 0.027     1.000   Klrg1       L2
Tigit    0.100  0.3537089 0.112 0.089     1.000   Tigit       L2
Cdc6     0.108 -1.2716820 0.012 0.022     1.000    Cdc6       L2
Havcr2   0.124  0.2263439 0.180 0.151     1.000  Havcr2       L2
Cxcr5    0.127 -0.3716689 0.037 0.052     1.000   Cxcr5       L2
Tox      0.161  0.2363673 0.752 0.747     1.000     Tox       L2
Tnfrsf9  0.173 -0.1395561 0.259 0.288     1.000 Tnfrsf9       L2
Lag3     0.258  0.2588542 0.276 0.257     1.000    Lag3       L2
Prf1     0.282  0.1809030 0.387 0.360     1.000    Prf1       L2
Klrc1    0.404 -0.1463218 0.554 0.561     1.000   Klrc1       L2
Slamf6   0.700 -0.1932184 0.276 0.275     1.000  Slamf6       L2
Gzmb     0.759 -0.2151104 0.418 0.419     1.000    Gzmb       L2
Ifng     0.962  0.2414061 0.290 0.296     1.000    Ifng       L2
Tox1     0.000  1.2085565 0.923 0.776     0.000     Tox       L3
Tigit1   0.001  0.6106363 0.524 0.340     1.000   Tigit       L3
Gzmk1    0.001  1.1624475 0.336 0.191     1.000    Gzmk       L3
Slamf61  0.002  0.6375175 0.587 0.415     1.000  Slamf6       L3
Nr4a11   0.007  1.2402224 0.301 0.178     1.000   Nr4a1       L3
Gzmb1    0.009 -1.4892233 0.545 0.593     1.000    Gzmb       L3
Cx3cr11  0.010  1.4684764 0.510 0.411     1.000  Cx3cr1       L3
Xcl11    0.028 -0.8875249 0.385 0.456     1.000    Xcl1       L3
Prf11    0.068  0.5342796 0.399 0.307     1.000    Prf1       L3
Lag31    0.076  0.3226731 0.636 0.560     1.000    Lag3       L3
Foxp31   0.084  0.2151854 0.385 0.286     1.000   Foxp3       L3
Klrg11   0.220 -0.5934911 0.280 0.199     1.000   Klrg1       L3
Nfkbia1  0.223 -0.1301000 0.895 0.851     1.000  Nfkbia       L3
Cxcr51   0.270  0.3764519 0.098 0.066     1.000   Cxcr5       L3
Pdcd12   0.285  0.2974293 0.727 0.697     1.000   Pdcd1       L3
Cd41     0.313  0.1354775 0.524 0.444     1.000     Cd4       L3
Klrc11   0.473 -0.3757994 0.462 0.432     1.000   Klrc1       L3
Cd69     0.556 -0.3227966 0.615 0.627     1.000    Cd69       L3
Mt1      0.567 -0.3455332 0.462 0.456     1.000     Mt1       L3
Tcf71    0.714  0.1640923 0.301 0.282     1.000    Tcf7       L3
Cd8a     0.757 -0.2775205 0.497 0.452     1.000    Cd8a       L3
Ifng1    0.813  0.7553383 0.455 0.432     1.000    Ifng       L3
Ccr71    0.845 -0.5566252 0.168 0.170     1.000    Ccr7       L3
Tox5     0.000  0.6562220 0.838 0.716     0.000     Tox       L1
Xcl12    0.000  0.7178196 0.144 0.070     0.000    Xcl1       L1
Gzmb2    0.000 -1.4747663 0.206 0.272     0.358    Gzmb       L1
Cd3e     0.000 -0.1582955 0.933 0.932     0.705    Cd3e       L1
Cd8a1    0.000  0.7650997 0.154 0.097     1.000    Cd8a       L1
Tigit2   0.000  0.4097759 0.223 0.161     1.000   Tigit       L1
Cd691    0.001  0.2892629 0.460 0.376     1.000    Cd69       L1
Nfkbia2  0.001 -0.3631663 0.592 0.635     1.000  Nfkbia       L1
Slamf62  0.003 -0.3289756 0.319 0.371     1.000  Slamf6       L1
Cx3cr12  0.019  0.4590380 0.192 0.156     1.000  Cx3cr1       L1
Ifng2    0.051 -0.1137932 0.149 0.118     1.000    Ifng       L1
Lag32    0.087  0.1952092 0.215 0.185     1.000    Lag3       L1
Tnfrsf91 0.163 -0.3654526 0.358 0.381     1.000 Tnfrsf9       L1
Havcr21  0.214  0.1119546 0.173 0.151     1.000  Havcr2       L1
Cxcr52   0.240  0.1431887 0.074 0.061     1.000   Cxcr5       L1
Prf12    0.253 -0.2332511 0.074 0.061     1.000    Prf1       L1
Cdc61    0.285  0.2780712 0.010 0.006     1.000    Cdc6       L1
Foxp32   0.329  0.1594547 0.337 0.320     1.000   Foxp3       L1
Cd42     0.344  0.1169509 0.647 0.646     1.000     Cd4       L1
Ccr72    0.386 -0.3838340 0.105 0.115     1.000    Ccr7       L1
Gzmk2    0.857 -0.7105102 0.064 0.064     1.000    Gzmk       L1
Mt11     0.915  0.1936797 0.087 0.085     1.000     Mt1       L1
Klrg12   0.933 -0.2522689 0.130 0.131     1.000   Klrg1       L1
Tox6     0.000  0.5213880 0.827 0.723     1.000     Tox       L5
Tigit3   0.003  0.4634831 0.197 0.114     1.000   Tigit       L5
Cx3cr13  0.004  0.1689233 0.979 0.983     1.000  Cx3cr1       L5
Cd692    0.025  0.2375402 0.569 0.491     1.000    Cd69       L5
Havcr22  0.030  0.2009605 0.805 0.765     1.000  Havcr2       L5
Gzmb3    0.036 -0.4128036 0.313 0.370     1.000    Gzmb       L5
Nr4a12   0.079  1.1038120 0.160 0.118     1.000   Nr4a1       L5
Ccr73    0.127 -0.4355934 0.094 0.125     1.000    Ccr7       L5
Cd43     0.140  0.2366766 0.452 0.391     1.000     Cd4       L5
Cdc62    0.170 -0.8195612 0.037 0.055     1.000    Cdc6       L5
Tnfrsf92 0.183 -0.5181043 0.347 0.377     1.000 Tnfrsf9       L5
Mt12     0.284 -0.1302319 0.570 0.516     1.000     Mt1       L5
Cxcr53   0.342  0.1171349 0.115 0.093     1.000   Cxcr5       L5
Cd3e1    0.348 -0.1135851 0.892 0.865     1.000    Cd3e       L5
Pdcd13   0.460  0.1571218 0.364 0.336     1.000   Pdcd1       L5
Foxp33   0.479 -0.1280989 0.178 0.197     1.000   Foxp3       L5
Nfkbia3  0.502 -0.1332637 0.886 0.875     1.000  Nfkbia       L5
Xcl13    0.538 -0.2823807 0.400 0.405     1.000    Xcl1       L5
Klrc12   0.633 -0.1682772 0.383 0.384     1.000   Klrc1       L5
Ifng3    0.707 -0.4360562 0.254 0.263     1.000    Ifng       L5
Klrg13   0.998 -0.3559418 0.084 0.083     1.000   Klrg1       L5
Prf13    0.000 -1.9929538 0.036 0.142     0.706    Prf1       B1
Havcr23  0.000  1.0066200 0.221 0.112     1.000  Havcr2       B1
Cx3cr14  0.001  1.2340341 0.317 0.221     1.000  Cx3cr1       B1
Lag33    0.005  0.6008714 0.265 0.174     1.000    Lag3       B1
Tcf72    0.007  2.2175914 0.064 0.022     1.000    Tcf7       B1
Cd3e2    0.009  0.9052857 0.133 0.071     1.000    Cd3e       B1
Ccr74    0.015  0.7265391 0.309 0.218     1.000    Ccr7       B1
Nr4a13   0.016 -0.3469984 0.116 0.060     1.000   Nr4a1       B1
Tox7     0.018  0.8088501 0.133 0.076     1.000     Tox       B1
Cd45     0.029  0.8682413 0.104 0.057     1.000     Cd4       B1
Cxcr54   0.029  0.2302729 0.498 0.384     1.000   Cxcr5       B1
Cd8a2    0.039  0.3874277 0.076 0.038     1.000    Cd8a       B1
Foxp34   0.067  1.7811500 0.044 0.019     1.000   Foxp3       B1
Cdc63    0.068 -0.8998872 0.024 0.054     1.000    Cdc6       B1
Klrc13   0.112 -1.9432886 0.020 0.044     1.000   Klrc1       B1
Mt13     0.243 -1.8888306 0.185 0.213     1.000     Mt1       B1
Nfkbia4  0.315 -0.1686915 0.795 0.853     1.000  Nfkbia       B1
Xcl14    0.564 -0.3391047 0.060 0.049     1.000    Xcl1       B1
Gzmb4    0.636  0.1477809 0.068 0.079     1.000    Gzmb       B1
Klrg14   0.728  0.5736619 0.020 0.016     1.000   Klrg1       B1
Ifng4    0.867 -1.5258314 0.028 0.030     1.000    Ifng       B1
Tigit4   0.886 -0.3393416 0.032 0.030     1.000   Tigit       B1
Klrg15   0.000  0.5906444 0.255 0.161     1.000   Klrg1       NK
Cd3e3    0.002  1.3704870 0.092 0.042     1.000    Cd3e       NK
Klrc14   0.002 -0.4360510 0.395 0.489     1.000   Klrc1       NK
Prf14    0.002  0.1998092 0.885 0.868     1.000    Prf1       NK
Cx3cr15  0.006  0.8495072 0.182 0.120     1.000  Cx3cr1       NK
Gzmb5    0.007 -0.7919324 0.624 0.692     1.000    Gzmb       NK
Tnfrsf93 0.038 -0.2669229 0.332 0.394     1.000 Tnfrsf9       NK
Cd693    0.044  0.4006831 0.305 0.250     1.000    Cd69       NK
Ifng5    0.075  0.1393783 0.311 0.250     1.000    Ifng       NK
Cd8a3    0.078  1.7624410 0.029 0.013     1.000    Cd8a       NK
Slamf63  0.221 -0.2951892 0.111 0.136     1.000  Slamf6       NK
Tcf73    0.226 -0.1058882 0.468 0.495     1.000    Tcf7       NK
Lag34    0.242 -0.3388638 0.058 0.078     1.000    Lag3       NK
Cd49     0.246  2.1417972 0.023 0.013     1.000     Cd4       NK
Pdcd14   0.434  1.3304344 0.013 0.008     1.000   Pdcd1       NK
Ccr75    0.449 -0.4322259 0.008 0.013     1.000    Ccr7       NK
Nfkbia5  0.567  0.1036380 0.497 0.478     1.000  Nfkbia       NK
Mt14     0.649 -0.6395518 0.029 0.034     1.000     Mt1       NK
Nr4a14   0.694  0.4770454 0.065 0.073     1.000   Nr4a1       NK
Havcr24  0.741 -0.4217653 0.015 0.017     1.000  Havcr2       NK
Cxcr55   0.051 -0.9252294 0.195 0.276     1.000   Cxcr5     Treg
Tnfrsf94 0.066 -0.6090058 0.409 0.473     1.000 Tnfrsf9     Treg
Ccr76    0.075 -0.2842068 0.913 0.916     1.000    Ccr7     Treg
Cx3cr16  0.088 -0.1641078 0.282 0.192     1.000  Cx3cr1     Treg
Slamf64  0.094  1.2713711 0.107 0.059     1.000  Slamf6     Treg
Nfkbia6  0.105 -0.1696647 0.946 0.921     1.000  Nfkbia     Treg
Cd694    0.124  0.2326701 0.128 0.079     1.000    Cd69     Treg
Havcr25  0.129  0.7087884 0.161 0.108     1.000  Havcr2     Treg
Gzmb6    0.193 -3.5006033 0.027 0.054     1.000    Gzmb     Treg
Tox8     0.247  1.9017765 0.107 0.074     1.000     Tox     Treg
Nr4a15   0.357  1.5381687 0.060 0.039     1.000   Nr4a1     Treg
Cd8a4    0.401 -1.8878311 0.040 0.059     1.000    Cd8a     Treg
Lag35    0.457  0.4612908 0.161 0.138     1.000    Lag3     Treg
Mt15     0.467 -0.2548196 0.436 0.438     1.000     Mt1     Treg
Klrg16   0.472  0.3969321 0.013 0.025     1.000   Klrg1     Treg
Klrc15   0.561 -1.6496046 0.020 0.030     1.000   Klrc1     Treg
Foxp35   0.584  0.8193153 0.040 0.030     1.000   Foxp3     Treg
Cd410    0.584  0.8041183 0.067 0.054     1.000     Cd4     Treg
Ifng6    0.587 -0.6546229 0.020 0.030     1.000    Ifng     Treg
Tigit5   0.614  0.9452975 0.034 0.025     1.000   Tigit     Treg
Pdcd15   0.616  0.4027817 0.114 0.099     1.000   Pdcd1     Treg
Tcf74    0.717 -0.1988103 0.369 0.379     1.000    Tcf7     Treg
Cdc64    0.749  0.4918512 0.013 0.010     1.000    Cdc6     Treg
Prf15    0.754 -0.4962852 0.007 0.010     1.000    Prf1     Treg
Cd3e4    0.827 -0.2191113 0.107 0.099     1.000    Cd3e     Treg
Gzmk3    0.962  0.7467637 0.020 0.020     1.000    Gzmk     Treg
Nfkbia7  0.018 -0.8148935 0.606 0.653     1.000  Nfkbia       B2
Mt16     0.041 -1.8199608 0.057 0.116     1.000     Mt1       B2
Tox9     0.054 -0.2700641 0.103 0.047     1.000     Tox       B2
Ccr77    0.059 -2.1575549 0.046 0.095     1.000    Ccr7       B2
Tcf75    0.064 -1.0948526 0.023 0.063     1.000    Tcf7       B2
Xcl15    0.098 -0.7671903 0.063 0.026     1.000    Xcl1       B2
Cxcr56   0.098 -1.3580971 0.034 0.074     1.000   Cxcr5       B2
Gzmk4    0.148  1.3123578 0.023 0.005     1.000    Gzmk       B2
Lag36    0.165  0.1471678 0.800 0.679     1.000    Lag3       B2
Cd411    0.178  0.1290432 0.606 0.495     1.000     Cd4       B2
Gzmb7    0.183  1.3874432 0.046 0.021     1.000    Gzmb       B2
Klrg17   0.211 -1.7283944 0.006 0.021     1.000   Klrg1       B2
Cd8a5    0.236 -0.4775908 0.337 0.368     1.000    Cd8a       B2
Pdcd16   0.255  1.3129416 0.034 0.016     1.000   Pdcd1       B2
Foxp36   0.274  1.7483238 0.017 0.005     1.000   Foxp3       B2
Tnfrsf95 0.319  1.0714810 0.046 0.026     1.000 Tnfrsf9       B2
Cd695    0.431 -0.2182169 0.291 0.337     1.000    Cd69       B2
Nr4a16   0.476 -1.3142508 0.029 0.042     1.000   Nr4a1       B2
Cdc65    0.609 -0.4338672 0.006 0.011     1.000    Cdc6       B2
Cd3e5    0.620  0.4704228 0.069 0.084     1.000    Cd3e       B2
Slamf65  0.633 -0.2346558 0.543 0.511     1.000  Slamf6       B2
Cx3cr17  0.744 -0.5169555 0.160 0.168     1.000  Cx3cr1       B2
Klrc16   0.899  0.8760166 0.023 0.021     1.000   Klrc1       B2
Ifng7    0.916  0.2582689 0.017 0.016     1.000    Ifng       B2
Tigit6   0.936  0.2251576 0.011 0.011     1.000   Tigit       B2
Havcr26  0.940 -0.2662552 0.143 0.137     1.000  Havcr2       B2
Havcr27  0.061 -1.1638339 0.083 0.200     1.000  Havcr2       L4
Tox10    0.070  0.7305110 0.708 0.564     1.000     Tox       L4
Gzmb8    0.084 -2.5537716 0.125 0.236     1.000    Gzmb       L4
Mt17     0.114  2.6485608 0.083 0.018     1.000     Mt1       L4
Foxp37   0.120 -2.2470710 0.028 0.091     1.000   Foxp3       L4
Cxcr57   0.129  3.7296380 0.042 0.000     1.000   Cxcr5       L4
Nfkbia8  0.193 -0.1111196 0.222 0.345     1.000  Nfkbia       L4
Pdcd17   0.273 -0.6022856 0.111 0.182     1.000   Pdcd1       L4
Cd412    0.274 -0.4002737 0.167 0.255     1.000     Cd4       L4
Cd3e6    0.281 -0.6662807 0.431 0.473     1.000    Cd3e       L4
Lag37    0.291 -0.4294829 0.111 0.182     1.000    Lag3       L4
Tcf76    0.294  0.5279148 0.319 0.236     1.000    Tcf7       L4
Klrc17   0.342  1.1139213 0.167 0.109     1.000   Klrc1       L4
Cd696    0.351  0.9632569 0.236 0.182     1.000    Cd69       L4
Cdc66    0.405 -2.3242974 0.014 0.036     1.000    Cdc6       L4
Ccr78    0.417  1.6810657 0.069 0.036     1.000    Ccr7       L4
Gzmk5    0.455  2.7845349 0.042 0.018     1.000    Gzmk       L4
Xcl16    0.459  0.2693893 0.236 0.182     1.000    Xcl1       L4
Prf16    0.461  1.3964308 0.181 0.145     1.000    Prf1       L4
Cd8a6    0.592 -0.4412113 0.111 0.145     1.000    Cd8a       L4
Tigit7   0.665 -1.2382408 0.056 0.073     1.000   Tigit       L4
Ifng8    0.675 -0.4200209 0.139 0.164     1.000    Ifng       L4
Cx3cr18  0.727 -0.8185450 0.153 0.164     1.000  Cx3cr1       L4
Klrg18   0.736 -2.1818924 0.042 0.055     1.000   Klrg1       L4
Slamf66  0.911  0.2197144 0.153 0.164     1.000  Slamf6       L4
Nr4a17   0.966  0.8289092 0.056 0.055     1.000   Nr4a1       L4
Cx3cr19  0.000  0.7274127 0.795 0.602     1.000  Cx3cr1       L6
Nfkbia9  0.000 -0.7256016 0.918 0.957     1.000  Nfkbia       L6
Cd3e7    0.001  0.4127927 0.953 0.828     1.000    Cd3e       L6
Tox11    0.008  0.3409457 0.854 0.753     1.000     Tox       L6
Gzmb9    0.034 -1.6592688 0.339 0.452     1.000    Gzmb       L6
Tigit8   0.038  1.0501625 0.275 0.172     1.000   Tigit       L6
Cd413    0.045  0.3629743 0.567 0.409     1.000     Cd4       L6
Klrc18   0.093 -0.8373769 0.292 0.376     1.000   Klrc1       L6
Mt18     0.182 -0.6715965 0.509 0.548     1.000     Mt1       L6
Nr4a18   0.207  1.0274767 0.257 0.194     1.000   Nr4a1       L6
Cd8a7    0.234  0.5646143 0.316 0.258     1.000    Cd8a       L6
Prf17    0.243 -0.9774681 0.246 0.301     1.000    Prf1       L6
Cd697    0.287  0.4513839 0.620 0.602     1.000    Cd69       L6
Xcl17    0.304 -0.6451654 0.287 0.333     1.000    Xcl1       L6
Ifng9    0.326  0.5896860 0.211 0.161     1.000    Ifng       L6
Ccr79    0.339 -0.2196368 0.117 0.075     1.000    Ccr7       L6
Cdc67    0.342  0.3791631 0.058 0.032     1.000    Cdc6       L6
Tnfrsf96 0.437 -0.5754994 0.456 0.495     1.000 Tnfrsf9       L6
Tcf77    0.491  0.2762796 0.456 0.419     1.000    Tcf7       L6
Slamf67  0.529  0.1319687 0.602 0.548     1.000  Slamf6       L6
Pdcd18   0.575  0.3830363 0.333 0.301     1.000   Pdcd1       L6
Lag38    0.588  0.6519597 0.345 0.344     1.000    Lag3       L6
Foxp38   0.616  0.3710284 0.322 0.301     1.000   Foxp3       L6
Cxcr58   0.851 -0.7539669 0.070 0.075     1.000   Cxcr5       L6
Gzmk6    0.980  0.3825908 0.129 0.129     1.000    Gzmk       L6</code></pre>
</div>
<div id="selected-myeloid-markers" class="section level3">
<h3>Selected myeloid markers</h3>
<pre class="r"><code># Mr1, H2-genes, 
#grep(&quot;^H2-&quot;, rownames(seurat_data), value = T)
#grep(&quot;^Apoe&quot;, rownames(seurat_data), value = T)

myel_plot_features &lt;- c(&quot;Cd68&quot;, &quot;Spp1&quot;, &quot;Mr1&quot;, &quot;C1qa&quot;, &quot;C1qb&quot;, &quot;C1qc&quot;, &quot;Apoe&quot;,
                         grep(&quot;^H2-&quot;, rownames(seurat_data), value = T))

myeloid &lt;- subset(seurat_data, subset = celltype %in% c(grep(&quot;^M&quot;, unique(seurat_data$celltype), value = T), c(&quot;Neut1&quot;)))
myeloid$celltype &lt;- factor(myeloid$celltype,
                           levels = sort(c(grep(&quot;^M&quot;, unique(myeloid$celltype), value = T), c(&quot;Neut1&quot;))))

VlnPlot(myeloid,
        features = myel_plot_features,
        group.by = &quot;Treatment&quot;,
        cols = treatment_col,
        pt.size = 0,
        slot = &quot;data&quot;) &amp;
  theme_classic() &amp;
  NoLegend() &amp;
  ylab(&quot;&quot;)</code></pre>
<p><img src="figure/cleaner_plots.Rmd/unnamed-chunk-19-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>VlnPlot(myeloid,
        features = myel_plot_features,
        group.by = &quot;celltype&quot;,
        split.by = &quot;Treatment&quot;,
        cols = treatment_col,
        pt.size = 0,
        ncol = 2,
        slot = &quot;data&quot;) &amp;
  theme_classic() &amp;
  NoLegend()</code></pre>
<p><img src="figure/cleaner_plots.Rmd/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ComplexHeatmap_2.18.0 viridis_0.6.3         viridisLite_0.4.2    
 [4] circlize_0.4.15       plyr_1.8.8            RColorBrewer_1.1-3   
 [7] CellChat_2.1.1        bigmemory_4.6.1       Biobase_2.62.0       
[10] BiocGenerics_0.48.1   igraph_1.4.3          googlesheets4_1.1.0  
[13] workflowr_1.7.1       ggpubr_0.6.0          lubridate_1.9.2      
[16] forcats_1.0.0         stringr_1.5.0         dplyr_1.1.2          
[19] purrr_1.0.2           readr_2.1.4           tidyr_1.3.0          
[22] tibble_3.2.1          ggplot2_3.4.2         tidyverse_2.0.0      
[25] SeuratDisk_0.0.0.9021 Seurat_5.0.1          SeuratObject_5.0.2   
[28] sp_1.6-1             

loaded via a namespace (and not attached):
  [1] fs_1.6.2               matrixStats_1.0.0      spatstat.sparse_3.0-1 
  [4] httr_1.4.6             doParallel_1.0.17      tools_4.3.0           
  [7] sctransform_0.4.1      backports_1.4.1        utf8_1.2.3            
 [10] R6_2.5.1               lazyeval_0.2.2         uwot_0.1.14           
 [13] GetoptLong_1.0.5       withr_2.5.0            gridExtra_2.3         
 [16] progressr_0.13.0       cli_3.6.1              spatstat.explore_3.2-1
 [19] fastDummies_1.7.3      network_1.18.1         labeling_0.4.2        
 [22] sass_0.4.6             spatstat.data_3.0-1    ggridges_0.5.4        
 [25] pbapply_1.7-0          systemfonts_1.0.4      svglite_2.1.1         
 [28] parallelly_1.36.0      limma_3.58.1           rstudioapi_0.14       
 [31] FNN_1.1.3.2            generics_0.1.3         shape_1.4.6           
 [34] ica_1.0-3              spatstat.random_3.1-5  car_3.1-2             
 [37] Matrix_1.6-5           ggbeeswarm_0.7.2       fansi_1.0.4           
 [40] S4Vectors_0.40.2       abind_1.4-5            lifecycle_1.0.3       
 [43] whisker_0.4.1          yaml_2.3.7             carData_3.0-5         
 [46] Rtsne_0.16             promises_1.2.0.1       crayon_1.5.2          
 [49] miniUI_0.1.1.1         lattice_0.21-8         cowplot_1.1.1         
 [52] sna_2.7-1              pillar_1.9.0           knitr_1.43            
 [55] rjson_0.2.21           future.apply_1.11.0    codetools_0.2-19      
 [58] leiden_0.4.3           glue_1.6.2             getPass_0.2-4         
 [61] data.table_1.14.8      vctrs_0.6.5            png_0.1-8             
 [64] spam_2.9-1             cellranger_1.1.0       gtable_0.3.3          
 [67] cachem_1.0.8           xfun_0.39              mime_0.12             
 [70] coda_0.19-4            survival_3.5-5         gargle_1.4.0          
 [73] iterators_1.0.14       statmod_1.5.0          ellipsis_0.3.2        
 [76] fitdistrplus_1.1-11    ROCR_1.0-11            nlme_3.1-162          
 [79] bit64_4.0.5            RcppAnnoy_0.0.20       rprojroot_2.0.3       
 [82] bslib_0.4.2            irlba_2.3.5.1          vipor_0.4.5           
 [85] KernSmooth_2.23-21     colorspace_2.1-0       ggrastr_1.0.2         
 [88] tidyselect_1.2.0       processx_3.8.1         bit_4.0.5             
 [91] compiler_4.3.0         curl_5.0.1             git2r_0.32.0          
 [94] BiocNeighbors_1.20.2   hdf5r_1.3.8            plotly_4.10.2         
 [97] scales_1.2.1           lmtest_0.9-40          callr_3.7.3           
[100] NMF_0.26               digest_0.6.31          goftest_1.2-3         
[103] spatstat.utils_3.0-3   presto_1.0.0           rmarkdown_2.22        
[106] htmltools_0.5.5        pkgconfig_2.0.3        highr_0.10            
[109] fastmap_1.1.1          rlang_1.1.1            GlobalOptions_0.1.2   
[112] htmlwidgets_1.6.2      shiny_1.7.4            farver_2.1.1          
[115] jquerylib_0.1.4        zoo_1.8-12             jsonlite_1.8.5        
[118] BiocParallel_1.36.0    statnet.common_4.9.0   magrittr_2.0.3        
[121] ggnetwork_0.5.12       dotCall64_1.0-2        patchwork_1.1.2       
[124] munsell_0.5.0          Rcpp_1.0.10            reticulate_1.29       
[127] stringi_1.7.12         ggalluvial_0.12.5      MASS_7.3-60           
[130] parallel_4.3.0         listenv_0.9.0          ggrepel_0.9.3         
[133] bigmemory.sri_0.1.6    deldir_1.0-9           splines_4.3.0         
[136] tensor_1.5             hms_1.1.3              ps_1.7.5              
[139] uuid_1.1-0             spatstat.geom_3.2-1    ggsignif_0.6.4        
[142] RcppHNSW_0.5.0         rngtools_1.5.2         reshape2_1.4.4        
[145] stats4_4.3.0           evaluate_0.21          BiocManager_1.30.20   
[148] tzdb_0.4.0             foreach_1.5.2          httpuv_1.6.11         
[151] RANN_2.6.1             polyclip_1.10-4        future_1.32.0         
[154] clue_0.3-64            scattermore_1.2        gridBase_0.4-7        
[157] broom_1.0.4            xtable_1.8-4           RSpectra_0.16-1       
[160] rstatix_0.7.2          later_1.3.1            googledrive_2.1.0     
[163] beeswarm_0.4.0         registry_0.5-1         IRanges_2.36.0        
[166] cluster_2.1.4          timechange_0.2.0       globals_0.16.2        </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
